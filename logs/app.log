2025-11-05 15:25:12 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:25:14 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:25:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:25:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:25:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:17 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:17 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:18 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:18 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:18 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:18 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 15:31:18 | INFO     | __main__:main:88 - Estrutura de diretórios verificada:
2025-11-05 15:31:18 | INFO     | __main__:main:99 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-05 15:31:18 | INFO     | watcher:detect_and_move_jobs:148 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-05 15:38:48 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 15:38:48 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 15:38:48 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 15:38:48 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 15:38:48 | ERROR    | watcher:process_job:133 - Erro ao processar job job_bmf_turismo_001: Arquivos listados no manifest não encontrados: ['cartao_cnpj.pdf']
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001D075EB2340>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001D075EB20C0>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001D078F72930>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001D078FF9BC0>
    └ ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='053700ac-544f-4eee-9650-ed063efafaf8', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
        └ <function exec_func_with_error_handling at 0x000001D078FB0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001D019B11080, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000001D02C1D19E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001D02C284360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000001D02C2842C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 97, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_001')
               └ <function load_manifest at 0x000001D02C1D31A0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 253, in load_manifest
    raise RuntimeError(msg)
                       └ "Arquivos listados no manifest não encontrados: ['cartao_cnpj.pdf']"

RuntimeError: Arquivos listados no manifest não encontrados: ['cartao_cnpj.pdf']
2025-11-05 15:38:48 | ERROR    | watcher:_move_to_error:79 - Job job_bmf_turismo_001 movido para /error/
2025-11-05 15:42:34 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 15:42:34 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 15:42:34 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 15:42:34 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 15:42:34 | ERROR    | watcher:process_job:133 - Erro ao processar job job_bmf_turismo_001: Arquivos listados no manifest não encontrados: ['cartao_cnpj (12)']
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001D075EB2340>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001D075EB20C0>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001D078F72930>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001D078FF9BC0>
    └ ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='053700ac-544f-4eee-9650-ed063efafaf8', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
        └ <function exec_func_with_error_handling at 0x000001D078FB0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001D019B11080, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000001D02C1D19E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001D02C284360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000001D02C2842C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 97, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_001')
               └ <function load_manifest at 0x000001D02C1D31A0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 253, in load_manifest
    raise RuntimeError(msg)
                       └ "Arquivos listados no manifest não encontrados: ['cartao_cnpj (12)']"

RuntimeError: Arquivos listados no manifest não encontrados: ['cartao_cnpj (12)']
2025-11-05 15:42:34 | ERROR    | watcher:_move_to_error:79 - Job job_bmf_turismo_001 movido para /error/
2025-11-05 15:44:19 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 15:44:19 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 15:44:19 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 15:44:19 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 15:44:19 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 15:44:19 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 15:44:19 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 15:44:19 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 15:44:59 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 15:44:59 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-05 15:49:09 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-11-05 15:49:09 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-11-05 15:49:58 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-11-05 15:49:58 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 15:49:58 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 15:49:58 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 15:50:02 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001D075EB2340>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001D075EB20C0>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001D078F72930>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001D078FF9BC0>
    └ ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='053700ac-544f-4eee-9650-ed063efafaf8', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
        └ <function exec_func_with_error_handling at 0x000001D078FB0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001D019B11080, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000001D02C1D19E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001D02C284360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000001D02C2842C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 107, in process_job
    ia1_result = validar_documentos_openai(job_id, ocr_result["dados_extraidos"], manifest, modo="padrao")
                 │                         │       │                              └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'status': 'OK', 'job_id': 'job_bmf_turismo_001', 'evidencias_dir': 'evidencias\\ocr\\job_bmf_turismo_001', 'dados_extraidos'...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000001D02C1D37E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x000001D02E530360>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000001D02E020EC0>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000001D02E021010>
                 └ <openai.OpenAI object at 0x000001D07AC01950>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '# Prompt Oficial — PJ (Societária)\nVersão: 2410\nAgente...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000001D02E020EC0>,)
           └ <function Completions.create at 0x000001D02E530220>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000001D07AC01950>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000001D02E020EC0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000001D02BF49C60>
           │    │          └ <openai.OpenAI object at 0x000001D07AC01950>
           │    └ ~ResponseT
           └ <function cast at 0x000001D075F093A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000001D02BF48400>
          └ <openai.OpenAI object at 0x000001D07AC01950>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 15:50:02 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 15:50:02 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 15:50:02 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 15:50:02 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 15:50:02 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 15:50:02 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 15:50:02 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001D075EB2340>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001D075EB20C0>
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 20908)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 20908)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001D078F72930>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001D078FF9BC0>
    └ ScriptRunner(_session_id='053700ac-544f-4eee-9650-ed063efafaf8', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='053700ac-544f-4eee-9650-ed063efafaf8', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
        └ <function exec_func_with_error_handling at 0x000001D078FB0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001D02C1D2520>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001D019B11080, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000001D02C1D19E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001D02C284360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000001D02C2842C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 122, in process_job
    ia2_result = validar_documentos_openai(job_id, ia2_input, manifest, modo="comparativo")
                 │                         │       │          └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'dados_ocr': "\n\n# cartao_cnpj.pdf (Docling)\n<!-- image -->\n\n## REPÚBLICA FEDERATIVA DO BRASIL\n\n## CADASTRO NACIONAL D...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000001D02C1D37E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x000001D02E530360>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000001D02E020EC0>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000001D02E021010>
                 └ <openai.OpenAI object at 0x000001D07AC01950>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '# Prompt Oficial — PJ (Societária)\nVersão: 2410\nAgente...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000001D02E020EC0>,)
           └ <function Completions.create at 0x000001D02E530220>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000001D07AC01950>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000001D02E020EC0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000001D02BF49C60>
           │    │          └ <openai.OpenAI object at 0x000001D07AC01950>
           │    └ ~ResponseT
           └ <function cast at 0x000001D075F093A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000001D02BF48400>
          └ <openai.OpenAI object at 0x000001D07AC01950>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 15:50:02 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 15:50:02 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 15:50:02 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 15:50:02 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 15:50:02 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 16:10:18 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:10:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:10:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:10:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:10:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:10:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:10:20 | INFO     | __main__:main:88 - Estrutura de diretórios verificada:
2025-11-05 16:10:20 | INFO     | __main__:main:93 - Modo DEBUG ativado
2025-11-05 16:10:20 | ERROR    | __main__:executar_pipeline_manual:49 - Manifesto não encontrado para o job job_bmf_turismo_001
2025-11-05 16:17:32 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:17:33 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:17:33 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:17:33 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:17:33 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:17:33 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 16:17:33 | INFO     | __main__:main:88 - Estrutura de diretórios verificada:
2025-11-05 16:17:33 | INFO     | __main__:main:99 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-05 16:17:33 | INFO     | watcher:detect_and_move_jobs:148 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-05 16:18:03 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 16:18:03 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_002
2025-11-05 16:18:03 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_002 movido para /processing
2025-11-05 16:18:03 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 16:18:03 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_002' → 'manifest.normalizado.json'
2025-11-05 16:18:03 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_002
2025-11-05 16:18:03 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 16:18:03 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 16:18:08 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 16:18:08 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-05 16:21:15 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-11-05 16:21:15 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-11-05 16:21:54 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-11-05 16:21:54 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 16:21:54 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 16:21:54 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 16:21:55 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_002')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 107, in process_job
    ia1_result = validar_documentos_openai(job_id, ocr_result["dados_extraidos"], manifest, modo="padrao")
                 │                         │       │                              └ {'job_id': 'job_bmf_turismo_002', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'status': 'OK', 'job_id': 'job_bmf_turismo_002', 'evidencias_dir': 'evidencias\\ocr\\job_bmf_turismo_002', 'dados_extraidos'...
                 │                         └ 'job_bmf_turismo_002'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 16:21:55 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 16:21:55 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 16:21:55 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 16:21:55 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 16:21:55 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 16:21:55 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 16:21:55 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_002')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 122, in process_job
    ia2_result = validar_documentos_openai(job_id, ia2_input, manifest, modo="comparativo")
                 │                         │       │          └ {'job_id': 'job_bmf_turismo_002', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'dados_ocr': "\n\n# cartao_cnpj.pdf (Docling)\n<!-- image -->\n\n## REPÚBLICA FEDERATIVA DO BRASIL\n\n## CADASTRO NACIONAL D...
                 │                         └ 'job_bmf_turismo_002'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 16:21:55 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 16:21:55 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 16:21:55 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_002\resultado
2025-11-05 16:21:55 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 16:21:55 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_002 movido para /done/
2025-11-05 16:30:41 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 16:30:41 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_002
2025-11-05 16:30:41 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_002 movido para /processing
2025-11-05 16:30:41 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 16:30:41 | ERROR    | watcher:process_job:133 - Erro ao processar job job_bmf_turismo_002: Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_002')
    └ <function process_job at 0x000002322D5ECF40>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 97, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_002')
               └ <function load_manifest at 0x000002327CC3C2C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 253, in load_manifest
    raise RuntimeError(msg)
                       └ "Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']"

RuntimeError: Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']
2025-11-05 16:30:41 | ERROR    | watcher:_move_to_error:79 - Job job_bmf_turismo_002 movido para /error/
2025-11-05 16:32:46 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 16:32:46 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 16:32:46 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 16:32:46 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 16:32:46 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 16:32:46 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 16:32:46 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 16:32:46 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 16:33:13 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 16:33:13 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-05 16:36:15 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-11-05 16:36:15 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-11-05 16:36:56 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-11-05 16:36:56 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 16:36:56 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 16:36:56 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 16:36:56 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 107, in process_job
    ia1_result = validar_documentos_openai(job_id, ocr_result["dados_extraidos"], manifest, modo="padrao")
                 │                         │       │                              └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'status': 'OK', 'job_id': 'job_bmf_turismo_001', 'evidencias_dir': 'evidencias\\ocr\\job_bmf_turismo_001', 'dados_extraidos'...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 16:36:56 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 16:36:56 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 16:36:56 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 16:36:56 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 16:36:56 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 16:36:56 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 16:36:56 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 122, in process_job
    ia2_result = validar_documentos_openai(job_id, ia2_input, manifest, modo="comparativo")
                 │                         │       │          └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'dados_ocr': "\n\n# cartao_cnpj.pdf (Docling)\n<!-- image -->\n\n## REPÚBLICA FEDERATIVA DO BRASIL\n\n## CADASTRO NACIONAL D...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 16:36:56 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 16:36:56 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 16:36:56 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 16:36:56 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 16:36:56 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 16:40:37 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 16:40:37 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 16:40:37 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 16:40:37 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 16:40:37 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 16:40:37 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 16:40:37 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 16:40:37 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 16:41:01 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 16:41:01 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-05 16:44:08 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-11-05 16:44:08 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-11-05 16:44:44 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-11-05 16:44:44 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 16:44:44 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 16:44:44 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 16:44:45 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 107, in process_job
    ia1_result = validar_documentos_openai(job_id, ocr_result["dados_extraidos"], manifest, modo="padrao")
                 │                         │       │                              └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'status': 'OK', 'job_id': 'job_bmf_turismo_001', 'evidencias_dir': 'evidencias\\ocr\\job_bmf_turismo_001', 'dados_extraidos'...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 16:44:45 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 16:44:45 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 16:44:45 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 16:44:45 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 16:44:45 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 16:44:45 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 16:44:45 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 122, in process_job
    ia2_result = validar_documentos_openai(job_id, ia2_input, manifest, modo="comparativo")
                 │                         │       │          └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'dados_ocr': "\n\n# cartao_cnpj.pdf (Docling)\n<!-- image -->\n\n## REPÚBLICA FEDERATIVA DO BRASIL\n\n## CADASTRO NACIONAL D...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 16:44:45 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 16:44:45 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 16:44:45 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 16:44:45 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 16:44:45 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 18:21:48 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 18:21:48 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 18:21:48 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 18:21:48 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 18:21:48 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 18:21:48 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 18:21:48 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 18:21:48 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 18:22:14 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 18:22:14 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 18:22:14 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 18:22:14 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 18:22:14 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 107, in process_job
    ia1_result = validar_documentos_openai(job_id, ocr_result["dados_extraidos"], manifest, modo="padrao")
                 │                         │       │                              └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'status': 'OK', 'job_id': 'job_bmf_turismo_001', 'evidencias_dir': 'evidencias\\ocr\\job_bmf_turismo_001', 'dados_extraidos'...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 18:22:14 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 18:22:14 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 18:22:14 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 18:22:14 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 18:22:14 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 18:22:14 | INFO     | doc_verifier_agent:validar_documentos_openai:67 - Enviando análise para OpenAI (PJ)...
2025-11-05 18:22:15 | ERROR    | doc_verifier_agent:validar_documentos_openai:115 - Erro ao validar via OpenAI: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023277D12340>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023277D120C0>
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21160)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21160)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002327AD929D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002327AE19BC0>
    └ ScriptRunner(_session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='408e812b-97b6-4cc8-adec-2f0efa11dee1', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
        └ <function exec_func_with_error_handling at 0x000002327ADD0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000002327B9756C0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002327A5E9BE0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 103, in <module>
    main()
    └ <function main at 0x000002327C9F6160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 100, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000002322D5ECFE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 155, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_001')
    └ <function process_job at 0x000002322D5ECF40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 122, in process_job
    ia2_result = validar_documentos_openai(job_id, ia2_input, manifest, modo="comparativo")
                 │                         │       │          └ {'job_id': 'job_bmf_turismo_001', 'fornecedor_id': '22157088000192', 'perfil_validacao': 'PJ', 'contexto': {'razao_social': '...
                 │                         │       └ {'dados_ocr': '\n\n# cartao_cnpj.pdf (Docling)\n<!-- image -->\n\n## REPÚBLICA FEDERATIVA DO BRASIL\n\n## CADASTRO NACIONAL D...
                 │                         └ 'job_bmf_turismo_001'
                 └ <function validar_documentos_openai at 0x000002322D5339C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\doc_verifier_agent.py", line 70, in validar_documentos_openai
    completion = client.chat.completions.create(
                 │      │    │           └ <function Completions.create at 0x0000023230536A20>
                 │      │    └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
                 │      └ <openai.resources.chat.chat.Chat object at 0x000002322EF586E0>
                 └ <openai.OpenAI object at 0x000002320D3ABCB0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_utils\_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           │     │       └ {'model': 'gpt-5-turbo', 'messages': [{'role': 'system', 'content': '## 1) System\nVocê é um **Validador Sênior de Documentaç...
           │     └ (<openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>,)
           └ <function Completions.create at 0x00000232305368E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\resources\chat\completions\completions.py", line 1156, in create
    return self._post(
           │    └ <bound method SyncAPIClient.post of <openai.OpenAI object at 0x000002320D3ABCB0>>
           └ <openai.resources.chat.completions.completions.Completions object at 0x000002322EF58440>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
           │    │          │    │       │        │            │                  └ openai.Stream[openai.types.chat.chat_completion_chunk.ChatCompletionChunk]
           │    │          │    │       │        │            └ False
           │    │          │    │       │        └ FinalRequestOptions(method='post', url='/chat/completions', params={}, headers=NOT_GIVEN, max_retries=NOT_GIVEN, timeout=NOT_...
           │    │          │    │       └ <class 'openai.types.chat.chat_completion.ChatCompletion'>
           │    │          │    └ <function SyncAPIClient.request at 0x000002322D3D13A0>
           │    │          └ <openai.OpenAI object at 0x000002320D3ABCB0>
           │    └ ~ResponseT
           └ <function cast at 0x0000023277D693A0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\openai\_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
          │    └ <function BaseClient._make_status_error_from_response at 0x000002322D3CBB00>
          └ <openai.OpenAI object at 0x000002320D3ABCB0>

openai.AuthenticationError: Error code: 401 - {'error': {'message': 'Incorrect API key provided: sk-proj-********************************************************************************************************************************************************iRkA. You can find your API key at https://platform.openai.com/account/api-keys.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_api_key'}}
2025-11-05 18:22:15 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 18:22:15 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 18:22:15 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 18:22:15 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 18:22:15 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | __main__:main:114 - Estrutura de diretórios verificada:
2025-11-05 18:37:05 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:37:05 | INFO     | __main__:main:114 - Estrutura de diretórios verificada:
2025-11-05 18:37:05 | INFO     | __main__:main:125 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-05 18:37:05 | INFO     | watcher:detect_and_move_jobs:148 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-05 18:37:05 | INFO     | __main__:main:125 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-05 18:37:05 | INFO     | watcher:detect_and_move_jobs:148 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-05 18:37:55 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 18:37:55 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 18:37:55 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 18:37:55 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 18:37:55 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 18:37:55 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 18:37:55 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 18:37:55 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 18:37:59 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 18:37:59 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 18:37:59 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 18:37:59 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 18:38:22 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-05 18:38:22 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 18:38:22 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 18:38:22 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 18:38:22 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 18:38:22 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 18:38:22 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 18:39:00 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (comparativo)
2025-11-05 18:39:00 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 18:39:00 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 18:39:00 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 18:39:00 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 18:39:00 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 18:56:33 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 18:56:33 | INFO     | __main__:consultar_cnpj:87 - Consultando CNPJ 27865757000102...
2025-11-05 18:56:54 | ERROR    | __main__:consultar_cnpj:128 - Erro na requisição SERPRO: HTTPSConnectionPool(host='api.serpro.gov.br', port=443): Max retries exceeded with url: /consulta-cnpj/v1/27865757000102 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed out. (connect timeout=20)'))
Traceback (most recent call last):

  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connection.py", line 198, in _new_conn
    sock = connection.create_connection(
           │          └ <function create_connection at 0x000001F0024659E0>
           └ <module 'urllib3.util.connection' from 'C:\\Users\\walte\\AppData\\Roaming\\Python\\Python313\\site-packages\\urllib3\\util\\...
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\util\connection.py", line 85, in create_connection
    raise err
          └ None
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\util\connection.py", line 73, in create_connection
    sock.connect(sa)
    │    │       └ ('200.198.225.75', 443)
    │    └ <method 'connect' of '_socket.socket' objects>
    └ <socket.socket [closed] fd=-1, family=2, type=1, proto=0>

TimeoutError: timed out


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 787, in urlopen
    response = self._make_request(
               │    └ <function HTTPConnectionPool._make_request at 0x000001F0026A4900>
               └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x000001F0033A17F0>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 488, in _make_request
    raise new_e
          └ ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed...
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 464, in _make_request
    self._validate_conn(conn)
    │    │              └ <urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>
    │    └ <function HTTPSConnectionPool._validate_conn at 0x000001F0026A4EA0>
    └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x000001F0033A17F0>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 1093, in _validate_conn
    conn.connect()
    │    └ <function HTTPSConnection.connect at 0x000001F0026A0860>
    └ <urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connection.py", line 753, in connect
    self.sock = sock = self._new_conn()
    │    │             │    └ <function HTTPConnection._new_conn at 0x000001F00269BE20>
    │    │             └ <urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>
    │    └ None
    └ <urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connection.py", line 207, in _new_conn
    raise ConnectTimeoutError(
          └ <class 'urllib3.exceptions.ConnectTimeoutError'>

urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed out. (connect timeout=20)')


The above exception was the direct cause of the following exception:


Traceback (most recent call last):

  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\requests\adapters.py", line 644, in send
    resp = conn.urlopen(
           │    └ <function HTTPConnectionPool.urlopen at 0x000001F0026A4AE0>
           └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x000001F0033A17F0>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\connectionpool.py", line 841, in urlopen
    retries = retries.increment(
              │       └ <function Retry.increment at 0x000001F0024928E0>
              └ Retry(total=0, connect=None, read=False, redirect=None, status=None)
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\urllib3\util\retry.py", line 519, in increment
    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
          │             │      │    │            └ ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed...
          │             │      │    └ ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed...
          │             │      └ '/consulta-cnpj/v1/27865757000102'
          │             └ <urllib3.connectionpool.HTTPSConnectionPool object at 0x000001F0033A17F0>
          └ <class 'urllib3.exceptions.MaxRetryError'>

urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='api.serpro.gov.br', port=443): Max retries exceeded with url: /consulta-cnpj/v1/27865757000102 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed out. (connect timeout=20)'))


During handling of the above exception, another exception occurred:


Traceback (most recent call last):

  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\consulta_serpro.py", line 146, in <module>
    resultado = consultar_cnpj(manifest_teste)
                │              └ {'job_id': 'job_teste', 'perfil_validacao': 'PJ', 'fornecedor_id': '27865757000102'}
                └ <function consultar_cnpj at 0x000001F0033AE520>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\consulta_serpro.py", line 106, in consultar_cnpj
    response = requests.get(url, headers=headers, timeout=20)
               │        │   │            └ {'Authorization': 'Bearer ', 'Accept': 'application/json'}
               │        │   └ 'https://api.serpro.gov.br/consulta-cnpj/v1/27865757000102'
               │        └ <function get at 0x000001F0028865C0>
               └ <module 'requests' from 'C:\\Users\\walte\\AppData\\Roaming\\Python\\Python313\\site-packages\\requests\\__init__.py'>

  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\requests\api.py", line 73, in get
    return request("get", url, params=params, **kwargs)
           │              │           │         └ {'headers': {'Authorization': 'Bearer ', 'Accept': 'application/json'}, 'timeout': 20}
           │              │           └ None
           │              └ 'https://api.serpro.gov.br/consulta-cnpj/v1/27865757000102'
           └ <function request at 0x000001F002886340>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\requests\api.py", line 59, in request
    return session.request(method=method, url=url, **kwargs)
           │       │              │           │      └ {'params': None, 'headers': {'Authorization': 'Bearer ', 'Accept': 'application/json'}, 'timeout': 20}
           │       │              │           └ 'https://api.serpro.gov.br/consulta-cnpj/v1/27865757000102'
           │       │              └ 'get'
           │       └ <function Session.request at 0x000001F0028C2980>
           └ <requests.sessions.Session object at 0x000001F0033A0C20>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\requests\sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           │    │    │       └ {'timeout': 20, 'allow_redirects': True, 'proxies': OrderedDict(), 'stream': False, 'verify': True, 'cert': None}
           │    │    └ <PreparedRequest [GET]>
           │    └ <function Session.send at 0x000001F0028C2E80>
           └ <requests.sessions.Session object at 0x000001F0033A0C20>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\requests\sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        │       │    │          └ {'timeout': 20, 'proxies': OrderedDict(), 'stream': False, 'verify': True, 'cert': None}
        │       │    └ <PreparedRequest [GET]>
        │       └ <function HTTPAdapter.send at 0x000001F0028C2200>
        └ <requests.adapters.HTTPAdapter object at 0x000001F0033A12B0>
  File "C:\Users\walte\AppData\Roaming\Python\Python313\site-packages\requests\adapters.py", line 665, in send
    raise ConnectTimeout(e, request=request)
          │                         └ <PreparedRequest [GET]>
          └ <class 'requests.exceptions.ConnectTimeout'>

requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='api.serpro.gov.br', port=443): Max retries exceeded with url: /consulta-cnpj/v1/27865757000102 (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001F0033A1BE0>, 'Connection to api.serpro.gov.br timed out. (connect timeout=20)'))
2025-11-05 19:11:41 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 19:11:41 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_003
2025-11-05 19:11:41 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_003 movido para /processing
2025-11-05 19:11:41 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 19:11:41 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_003' → 'manifest.normalizado.json'
2025-11-05 19:11:41 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_003
2025-11-05 19:11:41 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 19:11:41 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 19:11:48 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 19:11:48 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-05 19:15:12 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-11-05 19:15:12 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-11-05 19:15:54 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-11-05 19:15:54 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 19:15:54 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 19:15:54 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 19:16:25 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_003 (padrao)
2025-11-05 19:16:25 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 19:16:25 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 19:16:25 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 19:16:25 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 19:16:25 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 19:16:25 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 19:16:52 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_003 (comparativo)
2025-11-05 19:16:52 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 19:16:52 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 19:16:52 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_003\resultado
2025-11-05 19:16:52 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 19:16:52 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_003 movido para /done/
2025-11-05 19:32:24 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 19:33:37 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 19:33:37 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 19:33:37 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 19:33:37 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 19:33:37 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 19:33:37 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 19:33:37 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 19:33:37 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 19:34:05 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 19:34:05 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 19:34:05 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 19:34:05 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 19:34:25 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-05 19:34:25 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 19:34:25 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 19:34:25 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 19:34:25 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 19:34:25 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 19:34:25 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 19:34:52 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (comparativo)
2025-11-05 19:34:52 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 19:34:52 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 19:34:52 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 19:34:52 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 19:34:52 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 19:38:46 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 19:44:26 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 19:48:07 | INFO     | watcher:detect_and_move_jobs:153 - 1 job(s) detectado(s) no inbox.
2025-11-05 19:48:07 | INFO     | watcher:process_job:89 - Novo job detectado: job_bmf_turismo_001
2025-11-05 19:48:07 | INFO     | watcher:process_job:94 - Job job_bmf_turismo_001 movido para /processing
2025-11-05 19:48:07 | INFO     | manifest_loader:_load_external_schema_if_exists:93 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-05 19:48:07 | INFO     | manifest_loader:load_manifest:259 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-05 19:48:07 | INFO     | watcher:process_job:98 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-05 19:48:07 | INFO     | watcher:process_job:101 - Iniciando OCR/Docling...
2025-11-05 19:48:07 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-05 19:48:34 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-05 19:48:34 | INFO     | watcher:process_job:103 - OCR concluído com sucesso.
2025-11-05 19:48:34 | INFO     | watcher:process_job:106 - Executando IA Validador 1 (análise documental)...
2025-11-05 19:48:34 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 19:49:18 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-05 19:49:18 | INFO     | watcher:process_job:108 - Validação IA1 concluída.
2025-11-05 19:49:18 | INFO     | watcher:process_job:111 - Consultando API SERPRO...
2025-11-05 19:49:18 | ERROR    | consulta_serpro:consultar_cnpj:44 - CNPJ não informado no manifest.json
2025-11-05 19:49:18 | INFO     | watcher:process_job:113 - Consulta SERPRO concluída.
2025-11-05 19:49:18 | INFO     | watcher:process_job:116 - Executando IA Validador 2 (comparativa)...
2025-11-05 19:49:18 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-05 19:49:49 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (comparativo)
2025-11-05 19:49:49 | INFO     | watcher:process_job:123 - Validação IA2 concluída.
2025-11-05 19:49:49 | INFO     | watcher:process_job:126 - Gerando relatório final...
2025-11-05 19:49:49 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-05 19:49:49 | INFO     | watcher:process_job:128 - Relatório final gerado com sucesso.
2025-11-05 19:49:49 | INFO     | watcher:_move_to_done:70 - Job job_bmf_turismo_001 movido para /done/
2025-11-05 20:00:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:00:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:00:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:00:07 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-05 20:00:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:00:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:00:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:00:07 | INFO     | __main__:main:116 - Estrutura de diretórios verificada:
2025-11-05 20:00:07 | INFO     | __main__:main:121 - Modo DEBUG ativado
2025-11-05 20:00:07 | ERROR    | __main__:executar_pipeline_manual:75 - Manifesto não encontrado para o job job_bmf_turismo_003
2025-11-05 20:12:54 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:12:54 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:12:54 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:12:54 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-05 20:12:54 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:12:54 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:12:54 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:12:54 | INFO     | __main__:main:116 - Estrutura de diretórios verificada:
2025-11-05 20:12:54 | INFO     | __main__:main:121 - Modo DEBUG ativado
2025-11-05 20:12:54 | ERROR    | __main__:executar_pipeline_manual:75 - Manifesto não encontrado para o job job_bmf_turismo_003
2025-11-05 20:14:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:14:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:14:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:14:07 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-05 20:14:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:14:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:14:07 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:14:07 | INFO     | __main__:main:116 - Estrutura de diretórios verificada:
2025-11-05 20:14:07 | INFO     | __main__:main:121 - Modo DEBUG ativado
2025-11-05 20:14:07 | ERROR    | __main__:executar_pipeline_manual:75 - Manifesto não encontrado para o job job_bmf_turismo_003
2025-11-05 20:15:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:15:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:15:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:15:15 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-05 20:15:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:15:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:15:15 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-05 20:15:15 | INFO     | __main__:main:116 - Estrutura de diretórios verificada:
2025-11-05 20:15:15 | INFO     | __main__:main:121 - Modo DEBUG ativado
2025-11-05 20:15:15 | ERROR    | __main__:executar_pipeline_manual:75 - Manifesto não encontrado para o job job_bmf_turismo_003
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | INFO     | __main__:main:120 - Estrutura de diretórios verificada:
2025-11-06 06:47:23 | INFO     | __main__:main:125 - Modo DEBUG ativado
2025-11-06 06:47:23 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:47:23 | ERROR    | __main__:executar_pipeline_manual:79 - Manifesto não encontrado para o job job_bmf_turismo_001
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | INFO     | __main__:main:120 - Estrutura de diretórios verificada:
2025-11-06 06:48:38 | INFO     | __main__:main:125 - Modo DEBUG ativado
2025-11-06 06:48:38 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:48:38 | ERROR    | __main__:executar_pipeline_manual:79 - Manifesto não encontrado para o job job_bmf_turismo_001
2025-11-06 06:53:30 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:53:30 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:53:30 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:53:30 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 06:53:30 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:53:30 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:53:30 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:53:30 | INFO     | __main__:main:128 - Estrutura de diretórios verificada:
2025-11-06 06:53:30 | INFO     | __main__:main:133 - Modo DEBUG ativado
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | INFO     | __main__:main:131 - Estrutura de diretórios verificada:
2025-11-06 06:58:44 | INFO     | __main__:main:136 - Modo DEBUG ativado
2025-11-06 06:58:44 | WARNING  | __main__:executar_pipeline_manual:74 - [DEBUG] Conteúdo da pasta processing (processing):
2025-11-06 06:58:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 06:58:44 | WARNING  | __main__:executar_pipeline_manual:85 - [DEBUG] Verificando caminho do manifest: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\processing\job_bmf_turismo_003\manifest.json
2025-11-06 06:58:44 | WARNING  | __main__:executar_pipeline_manual:86 - [DEBUG] Existe? False
2025-11-06 06:58:44 | ERROR    | __main__:executar_pipeline_manual:90 - Manifesto não encontrado para o job job_bmf_turismo_003
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | INFO     | __main__:main:131 - Estrutura de diretórios verificada:
2025-11-06 07:01:20 | INFO     | __main__:main:136 - Modo DEBUG ativado
2025-11-06 07:01:20 | WARNING  | __main__:executar_pipeline_manual:74 - [DEBUG] Conteúdo da pasta processing (processing):
2025-11-06 07:01:20 | WARNING  | __main__:executar_pipeline_manual:76 -  - processing\job_bmf_turismo_003
2025-11-06 07:01:20 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:01:20 | WARNING  | __main__:executar_pipeline_manual:85 - [DEBUG] Verificando caminho do manifest: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\processing\job_bmf_turismo_003\manifest.json
2025-11-06 07:01:20 | WARNING  | __main__:executar_pipeline_manual:86 - [DEBUG] Existe? True
2025-11-06 07:01:20 | INFO     | __main__:executar_pipeline_manual:96 - Executando pipeline manual para depuração...
2025-11-06 07:01:20 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 07:01:33 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 07:01:33 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-06 07:08:45 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:08:45 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:08:45 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:08:45 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 07:08:45 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:08:45 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:08:45 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:08:45 | INFO     | __main__:main:131 - Estrutura de diretórios verificada:
2025-11-06 07:08:45 | INFO     | __main__:main:142 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-06 07:08:45 | INFO     | watcher:detect_and_move_jobs:186 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-06 07:08:45 | INFO     | watcher:detect_and_move_jobs:191 - 2 job(s) detectado(s) no inbox.
2025-11-06 07:08:45 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_003
2025-11-06 07:08:45 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_003 movido para /processing
2025-11-06 07:08:45 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_003: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002819C832340>
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002819C8320C0>
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 10644)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 10644)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002819F9E67F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002819FA6DBC0>
    └ ScriptRunner(_session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000281A057DD00>
        └ <function exec_func_with_error_handling at 0x000002819FA1CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000281A057DD00>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002819F2025B0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x00000281A162A3E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x00000281D216E700>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/05/job_bmf_turismo_003')
    └ <function process_job at 0x00000281D216E660>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 110, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_003')
               └ <function load_manifest at 0x00000281A27E0EA0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 223, in load_manifest
    LOGGER.info(f"[MANIFEST] Carregado de: {manifest_path} (exists={os.path.exists(manifest_path)})")
                                                                    │  │    └ <built-in function _path_exists>
                                                                    │  └ <module 'ntpath' (frozen)>
                                                                    └ <module 'os' (frozen)>

NameError: name 'LOGGER' is not defined
2025-11-06 07:08:45 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_003 movido para /error/
2025-11-06 07:08:45 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:08:45 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:08:45 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002819C832340>
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002819C8320C0>
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 10644)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 10644)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002819F9E67F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002819FA6DBC0>
    └ ScriptRunner(_session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000281A057DD00>
        └ <function exec_func_with_error_handling at 0x000002819FA1CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000281A057DD00>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002819F2025B0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x00000281A162A3E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x00000281D216E700>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x00000281D216E660>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 110, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_001')
               └ <function load_manifest at 0x00000281A27E0EA0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 223, in load_manifest
    LOGGER.info(f"[MANIFEST] Carregado de: {manifest_path} (exists={os.path.exists(manifest_path)})")
                                                                    │  │    └ <built-in function _path_exists>
                                                                    │  └ <module 'ntpath' (frozen)>
                                                                    └ <module 'os' (frozen)>

NameError: name 'LOGGER' is not defined
2025-11-06 07:08:45 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 07:11:15 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 07:11:15 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:11:15 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:11:15 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000002819C832340>
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000002819C8320C0>
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 10644)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 10644)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 10644)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000002819F9E67F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000002819FA6DBC0>
    └ ScriptRunner(_session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='31e171f4-4e7d-46b4-b8f9-ef43a42d0529', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000281A057DD00>
        └ <function exec_func_with_error_handling at 0x000002819FA1CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000281A057DD00>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000002819F2025B0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x00000281A162A3E0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x00000281D216E700>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x00000281D216E660>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 110, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_001')
               └ <function load_manifest at 0x00000281A27E0EA0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 223, in load_manifest
    LOGGER.info(f"[MANIFEST] Carregado de: {manifest_path} (exists={os.path.exists(manifest_path)})")
                                                                    │  │    └ <built-in function _path_exists>
                                                                    │  └ <module 'ntpath' (frozen)>
                                                                    └ <module 'os' (frozen)>

NameError: name 'LOGGER' is not defined
2025-11-06 07:11:15 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 07:13:34 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:13:34 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:13:34 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:13:34 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 07:13:34 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:13:34 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:13:34 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:13:34 | INFO     | __main__:main:131 - Estrutura de diretórios verificada:
2025-11-06 07:13:34 | INFO     | __main__:main:142 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-06 07:13:34 | INFO     | watcher:detect_and_move_jobs:186 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-06 07:14:39 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 07:14:39 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:14:39 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:14:39 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: cannot access local variable 'manifest_path' where it is not associated with a value
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000020EAC3F2340>
    └ <Thread(ScriptRunner.scriptThread, started 11448)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000020EAC3F20C0>
    └ <Thread(ScriptRunner.scriptThread, started 11448)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 11448)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 11448)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='0d149788-4ba8-405e-8577-d5ffa9235022', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 11448)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000020EAF5C6930>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000020EAF649BC0>
    └ ScriptRunner(_session_id='0d149788-4ba8-405e-8577-d5ffa9235022', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='0d149788-4ba8-405e-8577-d5ffa9235022', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000020EB22ECFE0>
        └ <function exec_func_with_error_handling at 0x0000020EAF5FCB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000020EB22ECFE0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000020EB0713410, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x0000020EB22ED620>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000020EE1EB2480>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x0000020EE1EB23E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 110, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_001')
               └ <function load_manifest at 0x0000020EB25E4F40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 227, in load_manifest
    LOGGER.debug({"dbg": "manifest_keys_loaded", "keys": list(data.keys())})
    │      └ <function Logger.debug at 0x0000020EB11959E0>
    └ <loguru.logger handlers=[(id=1, level=20, sink='logs\app.log'), (id=2, level=10, sink='logs\debug.log')]>

UnboundLocalError: cannot access local variable 'manifest_path' where it is not associated with a value
2025-11-06 07:14:39 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 07:17:04 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 07:17:04 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:17:04 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:17:04 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: cannot access local variable 'manifest_path' where it is not associated with a value
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000020EAC3F2340>
    └ <Thread(ScriptRunner.scriptThread, started 11448)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000020EAC3F20C0>
    └ <Thread(ScriptRunner.scriptThread, started 11448)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 11448)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 11448)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='0d149788-4ba8-405e-8577-d5ffa9235022', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 11448)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000020EAF5C6930>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000020EAF649BC0>
    └ ScriptRunner(_session_id='0d149788-4ba8-405e-8577-d5ffa9235022', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='0d149788-4ba8-405e-8577-d5ffa9235022', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000020EB22ECFE0>
        └ <function exec_func_with_error_handling at 0x0000020EAF5FCB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000020EB22ECFE0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000020EB0713410, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x0000020EB22ED620>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000020EE1EB2480>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x0000020EE1EB23E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 110, in process_job
    manifest = load_manifest(job_dir_processing)
               │             └ WindowsPath('processing/job_bmf_turismo_001')
               └ <function load_manifest at 0x0000020EB25E4F40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 227, in load_manifest
    LOGGER.debug({"dbg": "manifest_keys_loaded", "keys": list(data.keys())})
    │      └ <function Logger.debug at 0x0000020EB11959E0>
    └ <loguru.logger handlers=[(id=1, level=20, sink='logs\app.log'), (id=2, level=10, sink='logs\debug.log')]>

UnboundLocalError: cannot access local variable 'manifest_path' where it is not associated with a value
2025-11-06 07:17:04 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | __main__:main:131 - Estrutura de diretórios verificada:
2025-11-06 07:23:19 | INFO     | __main__:main:142 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-06 07:23:19 | INFO     | watcher:detect_and_move_jobs:186 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-06 07:23:19 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 07:23:19 | INFO     | __main__:main:131 - Estrutura de diretórios verificada:
2025-11-06 07:23:19 | INFO     | __main__:main:142 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-06 07:23:19 | INFO     | watcher:detect_and_move_jobs:186 - Watcher iniciado. Monitorando /inbox por novos jobs...
2025-11-06 07:24:54 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 07:24:54 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:24:54 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:24:54 | INFO     | manifest_loader:load_manifest:233 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_001\manifest.json (exists=True)
2025-11-06 07:24:54 | INFO     | manifest_loader:_load_external_schema_if_exists:97 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-06 07:24:54 | INFO     | manifest_loader:load_manifest:271 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-06 07:24:54 | INFO     | watcher:process_job:111 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-06 07:24:54 | INFO     | watcher:process_job:114 - Iniciando OCR/Docling...
2025-11-06 07:24:54 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 07:25:00 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 07:25:00 | INFO     | watcher:process_job:116 - OCR concluído com sucesso.
2025-11-06 07:25:00 | INFO     | watcher:process_job:119 - Executando IA Validador 1 (análise documental)...
2025-11-06 07:25:00 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 07:25:46 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-06 07:25:46 | INFO     | watcher:process_job:121 - Validação IA1 concluída.
2025-11-06 07:25:46 | INFO     | watcher:process_job:124 - Consultando dados ReceitaWS...
2025-11-06 07:25:46 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'manifest_data' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001CE26FA2340>
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001CE26FA20C0>
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21608)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21608)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001CE2A0127F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001CE2A099BC0>
    └ ScriptRunner(_session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE441F6480>
        └ <function exec_func_with_error_handling at 0x000001CE2A050B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE441F6480>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001CE29A14010, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x000001CE5C7EEC00>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001CE5C7EE980>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x000001CE5C7EE8E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 126, in process_job
    _stage_manifest_for_serpro(job_id, manifest_data, DIRS)
    │                          │                      └ {'BASE_DIR': 'C:\\Users\\walte\\OneDrive\\Workspace\\IA\\LICITANET\\Projeto_Valida\\Licitanet_OCR_OpenAI_V2', 'INBOX_DIR': 'i...
    │                          └ 'job_bmf_turismo_001'
    └ <function _stage_manifest_for_serpro at 0x000001CE2CC596C0>

NameError: name 'manifest_data' is not defined
2025-11-06 07:25:46 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 07:38:14 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 07:38:14 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:38:14 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:38:14 | INFO     | manifest_loader:load_manifest:233 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_001\manifest.json (exists=True)
2025-11-06 07:38:14 | INFO     | manifest_loader:_load_external_schema_if_exists:97 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-06 07:38:14 | INFO     | manifest_loader:load_manifest:271 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-06 07:38:14 | INFO     | watcher:process_job:111 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-06 07:38:14 | INFO     | watcher:process_job:114 - Iniciando OCR/Docling...
2025-11-06 07:38:14 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 07:38:19 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 07:38:19 | INFO     | watcher:process_job:116 - OCR concluído com sucesso.
2025-11-06 07:38:19 | INFO     | watcher:process_job:119 - Executando IA Validador 1 (análise documental)...
2025-11-06 07:38:19 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 07:38:37 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-06 07:38:37 | INFO     | watcher:process_job:121 - Validação IA1 concluída.
2025-11-06 07:38:37 | INFO     | watcher:process_job:124 - Consultando dados ReceitaWS...
2025-11-06 07:38:37 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'manifest_data' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001CE26FA2340>
    └ <Thread(ScriptRunner.scriptThread, started 23520)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001CE26FA20C0>
    └ <Thread(ScriptRunner.scriptThread, started 23520)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 23520)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 23520)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='51107e73-9176-4ac8-8e53-23f65ce74a6c', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 23520)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001CE2A0127F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x000001CE2A099BC0>
    └ ScriptRunner(_session_id='51107e73-9176-4ac8-8e53-23f65ce74a6c', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='51107e73-9176-4ac8-8e53-23f65ce74a6c', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE2AC01580>
        └ <function exec_func_with_error_handling at 0x000001CE2A050B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE2AC01580>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001CE29A14010, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x000001CE5C7EEA20>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001CE5C7EE980>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x000001CE5C7EE8E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 126, in process_job
    _stage_manifest_for_serpro(job_id, manifest_data, DIRS)
    │                          │                      └ {'BASE_DIR': 'C:\\Users\\walte\\OneDrive\\Workspace\\IA\\LICITANET\\Projeto_Valida\\Licitanet_OCR_OpenAI_V2', 'INBOX_DIR': 'i...
    │                          └ 'job_bmf_turismo_001'
    └ <function _stage_manifest_for_serpro at 0x000001CE2CC596C0>

NameError: name 'manifest_data' is not defined
2025-11-06 07:38:37 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 07:44:32 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 07:44:32 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 07:44:32 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 07:44:32 | INFO     | manifest_loader:load_manifest:233 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_001\manifest.json (exists=True)
2025-11-06 07:44:32 | INFO     | manifest_loader:_load_external_schema_if_exists:97 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-06 07:44:32 | INFO     | manifest_loader:load_manifest:271 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-06 07:44:32 | INFO     | watcher:process_job:111 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-06 07:44:32 | INFO     | watcher:process_job:114 - Iniciando OCR/Docling...
2025-11-06 07:44:32 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 07:44:59 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 07:44:59 | INFO     | watcher:process_job:116 - OCR concluído com sucesso.
2025-11-06 07:44:59 | INFO     | watcher:process_job:119 - Executando IA Validador 1 (análise documental)...
2025-11-06 07:44:59 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 07:45:20 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-06 07:45:20 | INFO     | watcher:process_job:121 - Validação IA1 concluída.
2025-11-06 07:45:20 | INFO     | watcher:process_job:124 - Consultando dados ReceitaWS...
2025-11-06 07:45:20 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'manifest_data' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001CE26FA2340>
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001CE26FA20C0>
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21608)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21608)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001CE2A0127F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001CE2A099BC0>
    └ ScriptRunner(_session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE441F6480>
        └ <function exec_func_with_error_handling at 0x000001CE2A050B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE441F6480>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001CE29A14010, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x000001CE5C7EEC00>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001CE5C7EE980>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x000001CE5C7EE8E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 126, in process_job
    _stage_manifest_for_serpro(job_id, manifest_data, DIRS)
    │                          │                      └ {'BASE_DIR': 'C:\\Users\\walte\\OneDrive\\Workspace\\IA\\LICITANET\\Projeto_Valida\\Licitanet_OCR_OpenAI_V2', 'INBOX_DIR': 'i...
    │                          └ 'job_bmf_turismo_001'
    └ <function _stage_manifest_for_serpro at 0x000001CE2CC596C0>

NameError: name 'manifest_data' is not defined
2025-11-06 07:45:20 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 08:28:02 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 08:28:02 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 08:28:02 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 08:28:02 | INFO     | manifest_loader:load_manifest:233 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_001\manifest.json (exists=True)
2025-11-06 08:28:02 | INFO     | manifest_loader:_load_external_schema_if_exists:97 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-06 08:28:02 | INFO     | manifest_loader:load_manifest:271 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-06 08:28:02 | INFO     | watcher:process_job:111 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-06 08:28:02 | INFO     | watcher:process_job:114 - Iniciando OCR/Docling...
2025-11-06 08:28:02 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 08:28:29 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 08:28:29 | INFO     | watcher:process_job:116 - OCR concluído com sucesso.
2025-11-06 08:28:29 | INFO     | watcher:process_job:119 - Executando IA Validador 1 (análise documental)...
2025-11-06 08:28:29 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 08:29:14 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-06 08:29:14 | INFO     | watcher:process_job:121 - Validação IA1 concluída.
2025-11-06 08:29:14 | INFO     | watcher:process_job:124 - Consultando dados ReceitaWS...
2025-11-06 08:29:14 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'manifest_data' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001CE26FA2340>
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001CE26FA20C0>
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21608)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21608)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21608)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001CE2A0127F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001CE2A099BC0>
    └ ScriptRunner(_session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='164d0032-0bc7-42ea-a6c4-422f86a91505', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE441F6480>
        └ <function exec_func_with_error_handling at 0x000001CE2A050B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE441F6480>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001CE29A14010, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x000001CE5C7EEC00>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001CE5C7EE980>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x000001CE5C7EE8E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 126, in process_job
    _stage_manifest_for_serpro(job_id, manifest_data, DIRS)
    │                          │                      └ {'BASE_DIR': 'C:\\Users\\walte\\OneDrive\\Workspace\\IA\\LICITANET\\Projeto_Valida\\Licitanet_OCR_OpenAI_V2', 'INBOX_DIR': 'i...
    │                          └ 'job_bmf_turismo_001'
    └ <function _stage_manifest_for_serpro at 0x000001CE2CC596C0>

NameError: name 'manifest_data' is not defined
2025-11-06 08:29:14 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 08:42:04 | INFO     | watcher:detect_and_move_jobs:191 - 1 job(s) detectado(s) no inbox.
2025-11-06 08:42:04 | INFO     | watcher:process_job:102 - Novo job detectado: job_bmf_turismo_001
2025-11-06 08:42:04 | INFO     | watcher:process_job:107 - Job job_bmf_turismo_001 movido para /processing
2025-11-06 08:42:04 | INFO     | manifest_loader:load_manifest:233 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_001\manifest.json (exists=True)
2025-11-06 08:42:04 | INFO     | manifest_loader:_load_external_schema_if_exists:97 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-06 08:42:04 | INFO     | manifest_loader:load_manifest:271 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-06 08:42:04 | INFO     | watcher:process_job:111 - Manifest carregado com sucesso para job job_bmf_turismo_001
2025-11-06 08:42:04 | INFO     | watcher:process_job:114 - Iniciando OCR/Docling...
2025-11-06 08:42:04 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 08:42:29 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 08:42:29 | INFO     | watcher:process_job:116 - OCR concluído com sucesso.
2025-11-06 08:42:29 | INFO     | watcher:process_job:119 - Executando IA Validador 1 (análise documental)...
2025-11-06 08:42:29 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 08:43:03 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-06 08:43:03 | INFO     | watcher:process_job:121 - Validação IA1 concluída.
2025-11-06 08:43:03 | INFO     | watcher:process_job:124 - Consultando dados ReceitaWS...
2025-11-06 08:43:03 | ERROR    | watcher:process_job:171 - Erro ao processar job job_bmf_turismo_001: name 'manifest_data' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001CE26FA2340>
    └ <Thread(ScriptRunner.scriptThread, started 23520)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001CE26FA20C0>
    └ <Thread(ScriptRunner.scriptThread, started 23520)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 23520)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 23520)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='51107e73-9176-4ac8-8e53-23f65ce74a6c', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 23520)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001CE2A0127F0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x000001CE2A099BC0>
    └ ScriptRunner(_session_id='51107e73-9176-4ac8-8e53-23f65ce74a6c', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='51107e73-9176-4ac8-8e53-23f65ce74a6c', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE2AC01580>
        └ <function exec_func_with_error_handling at 0x000001CE2A050B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE2AC01580>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001CE29A14010, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 146, in <module>
    main()
    └ <function main at 0x000001CE5C7EEA20>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 143, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001CE5C7EE980>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 193, in detect_and_move_jobs
    process_job(job)
    │           └ WindowsPath('inbox/2025/11/06/job_bmf_turismo_001')
    └ <function process_job at 0x000001CE5C7EE8E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 126, in process_job
    _stage_manifest_for_serpro(job_id, manifest_data, DIRS)
    │                          │                      └ {'BASE_DIR': 'C:\\Users\\walte\\OneDrive\\Workspace\\IA\\LICITANET\\Projeto_Valida\\Licitanet_OCR_OpenAI_V2', 'INBOX_DIR': 'i...
    │                          └ 'job_bmf_turismo_001'
    └ <function _stage_manifest_for_serpro at 0x000001CE2CC596C0>

NameError: name 'manifest_data' is not defined
2025-11-06 08:43:03 | ERROR    | watcher:_move_to_error:92 - Job job_bmf_turismo_001 movido para /error/
2025-11-06 08:52:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 08:52:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 08:52:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 08:52:44 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-06 08:52:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 08:52:44 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-06 08:52:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 08:52:44 | INFO     | log_service:init_folders:101 - Estrutura de diretórios inicializada com sucesso.
2025-11-06 08:52:44 | INFO     | __main__:main:140 - Estrutura de diretórios verificada:
2025-11-06 08:52:44 | INFO     | __main__:main:151 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-06 08:52:44 | INFO     | watcher:detect_and_move_jobs:170 - Iniciando monitoramento do diretório /inbox …
2025-11-06 08:52:44 | INFO     | watcher:detect_and_move_jobs:174 - 1 job(s) detectado(s) em /inbox.
2025-11-06 08:52:44 | INFO     | log_service:registrar_evento:123 - [job_bmf_turismo_001] [WATCHER] Novo job detectado em inbox: inbox/2025/11/06/job_bmf_turismo_001
2025-11-06 08:52:44 | INFO     | log_service:registrar_evento:123 - [job_bmf_turismo_001] [WATCHER] Job movido para processing: processing/job_bmf_turismo_001
2025-11-06 08:52:44 | INFO     | manifest_loader:load_manifest:233 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_001\manifest.json (exists=True)
2025-11-06 08:52:44 | INFO     | manifest_loader:_load_external_schema_if_exists:97 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-06 08:52:44 | INFO     | manifest_loader:load_manifest:271 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_001' → 'manifest.normalizado.json'
2025-11-06 08:52:44 | INFO     | watcher:process_job:124 - [job_bmf_turismo_001] Iniciando OCR/Docling…
2025-11-06 08:52:44 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-06 08:52:57 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-06 08:52:57 | INFO     | watcher:process_job:126 - [job_bmf_turismo_001] OCR/Docling concluído: OK
2025-11-06 08:52:57 | INFO     | watcher:process_job:129 - [job_bmf_turismo_001] Iniciando IA Validador 1…
2025-11-06 08:52:57 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 08:53:20 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (padrao)
2025-11-06 08:53:20 | INFO     | watcher:process_job:131 - [job_bmf_turismo_001] IA1 concluída: OK
2025-11-06 08:53:20 | INFO     | watcher:process_job:134 - [job_bmf_turismo_001] Consultando dados ReceitaWS…
2025-11-06 08:53:20 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_bmf_turismo_001] Manifest staged para ReceitaWS: outbox/job_bmf_turismo_001/serpro/manifest_for_serpro.json
2025-11-06 08:53:21 | INFO     | consulta_serpro:_mark_manifest_done:67 - [RECEITAWS] Manifesto marcado como done: outbox\job_bmf_turismo_001\serpro\manifest_for_serpro.done.json
2025-11-06 08:53:21 | INFO     | watcher:process_job:140 - [job_bmf_turismo_001] ReceitaWS concluída: OK
2025-11-06 08:53:21 | INFO     | watcher:process_job:143 - [job_bmf_turismo_001] Iniciando IA Validador 2 (comparativa)…
2025-11-06 08:53:21 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-06 08:53:51 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_001 (comparativo)
2025-11-06 08:53:51 | INFO     | watcher:process_job:150 - [job_bmf_turismo_001] IA2 concluída: OK
2025-11-06 08:53:51 | INFO     | watcher:process_job:153 - [job_bmf_turismo_001] Gerando relatório final…
2025-11-06 08:53:51 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_001\resultado
2025-11-06 08:53:51 | INFO     | watcher:process_job:155 - [job_bmf_turismo_001] Relatório final gerado.
2025-11-06 08:53:51 | INFO     | log_service:registrar_evento:123 - [job_bmf_turismo_001] [WATCHER] Pipeline concluído com sucesso
2025-11-12 16:05:37.253 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:05:37.300 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:05:37.317 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:05:37.320 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:05:37.342 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:05:37.345 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:05:37.382 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:05:37.395 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:09:15.360 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:10:07.838 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:10:56.511 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:11:08.898 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:11:12.111 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:11:29.117 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.394 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.399 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.405 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.405 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:12:10.410 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.411 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:12:10.417 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.422 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:12:10.423 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:17:48.859 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:17:48.862 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:17:48.866 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:17:48.867 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:17:48.871 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:17:48.872 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:17:48.876 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:17:48.880 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:17:48.881 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:18:46.715 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.622 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.629 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.638 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.639 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:20:20.650 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.651 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:20:20.654 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.659 | INFO     | log_service:init_folders:112 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:20:20.659 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:22:18.334 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:22:18.340 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:22:18.345 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:22:18.346 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:22:18.350 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:22:18.352 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:22:18.355 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:22:18.360 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:22:18.361 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:22:18.363 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:22:18.363 | INFO     | watcher:detect_and_move_jobs:170 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:22:18.367 | INFO     | watcher:detect_and_move_jobs:174 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:22:18.368 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:22:18.372 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:22:18.374 | ERROR    | watcher:process_job:162 - [12] Erro durante o processamento do job: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001F6B76C2340>
    └ <Thread(ScriptRunner.scriptThread, started 26592)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001F6B76C20C0>
    └ <Thread(ScriptRunner.scriptThread, started 26592)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 26592)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 26592)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='429992d4-845a-42b2-9fbf-7215d45aa43a', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 26592)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001F6BA852C00>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x000001F6BA8CDBC0>
    └ ScriptRunner(_session_id='429992d4-845a-42b2-9fbf-7215d45aa43a', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='429992d4-845a-42b2-9fbf-7215d45aa43a', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001F6BB3E1800>
        └ <function exec_func_with_error_handling at 0x000001F6BA87CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001F6BB3E1800>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001F6B9319160, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001F6BD54C4A0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001F6ECFF6200>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 176, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/12')
    └ <function process_job at 0x000001F6ECFF6160>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/12')
              │         │      └ <function load_manifest at 0x000001F6BD675120>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 236, in load_manifest
    LOGGER.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                 │                       │             └ <function PathBase.exists at 0x000001F6B9CC3880>
                                                 │                       └ WindowsPath('processing/12/manifest.json')
                                                 └ WindowsPath('processing/12/manifest.json')

NameError: name 'LOGGER' is not defined
2025-11-12 16:27:06.463 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:27:06.468 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:27:06.474 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:27:06.475 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:27:06.479 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:27:06.480 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:27:06.483 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:27:06.487 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:27:06.488 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:27:06.489 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:27:06.490 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:33:07.405 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:33:07.409 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:33:07.412 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:33:07.412 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:33:07.416 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:33:07.416 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:33:07.419 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:33:07.423 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:33:07.423 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:33:07.425 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:33:07.426 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:34:12.494 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:34:12.496 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_004] WATCHER
2025-11-12 16:34:12.500 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_004] WATCHER
2025-11-12 16:34:12.502 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_004] Erro durante o processamento do job: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000022F99822340>
    └ <Thread(ScriptRunner.scriptThread, started 4032)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000022F998220C0>
    └ <Thread(ScriptRunner.scriptThread, started 4032)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 4032)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 4032)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='68cb584b-f9c8-4237-bb08-a10a6d761370', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 4032)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000022F9C922D90>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x0000022F9C99DBC0>
    └ ScriptRunner(_session_id='68cb584b-f9c8-4237-bb08-a10a6d761370', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='68cb584b-f9c8-4237-bb08-a10a6d761370', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000022F9D4E59E0>
        └ <function exec_func_with_error_handling at 0x0000022F9C94CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000022F9D4E59E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000022F9C0CF250, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000022F9F6587C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000022FCF17A5C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12/job_bmf_turismo_004')
    └ <function process_job at 0x0000022FCF17A520>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/job_bmf_turismo_004')
              │         │      └ <function load_manifest at 0x0000022F9F78D440>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 236, in load_manifest
    LOGGER.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                 │                       │             └ <function PathBase.exists at 0x0000022F9BD93880>
                                                 │                       └ WindowsPath('processing/job_bmf_turismo_004/manifest.json')
                                                 └ WindowsPath('processing/job_bmf_turismo_004/manifest.json')

NameError: name 'LOGGER' is not defined
2025-11-12 16:34:12.515 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: name 'LOGGER' is not defined
2025-11-12 16:34:47.548 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:34:47.548 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_004] WATCHER
2025-11-12 16:34:47.552 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_004] WATCHER
2025-11-12 16:34:47.553 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_004] Erro durante o processamento do job: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000022F99822340>
    └ <Thread(ScriptRunner.scriptThread, started 4032)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000022F998220C0>
    └ <Thread(ScriptRunner.scriptThread, started 4032)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 4032)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 4032)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='68cb584b-f9c8-4237-bb08-a10a6d761370', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 4032)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000022F9C922D90>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x0000022F9C99DBC0>
    └ ScriptRunner(_session_id='68cb584b-f9c8-4237-bb08-a10a6d761370', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='68cb584b-f9c8-4237-bb08-a10a6d761370', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000022F9D4E59E0>
        └ <function exec_func_with_error_handling at 0x0000022F9C94CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000022F9D4E59E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000022F9C0CF250, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000022F9F6587C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000022FCF17A5C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12/job_bmf_turismo_004')
    └ <function process_job at 0x0000022FCF17A520>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/job_bmf_turismo_004')
              │         │      └ <function load_manifest at 0x0000022F9F78D440>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 236, in load_manifest
    LOGGER.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                 │                       │             └ <function PathBase.exists at 0x0000022F9BD93880>
                                                 │                       └ WindowsPath('processing/job_bmf_turismo_004/manifest.json')
                                                 └ WindowsPath('processing/job_bmf_turismo_004/manifest.json')

NameError: name 'LOGGER' is not defined
2025-11-12 16:35:48.950 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:35:48.955 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:35:48.960 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:35:48.960 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:35:48.963 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:35:48.964 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:35:48.967 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:35:48.971 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:35:48.972 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:35:48.973 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:35:48.974 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:35:53.983 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:35:53.983 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_004] WATCHER
2025-11-12 16:38:23.013 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:38:23.017 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:38:23.024 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:38:23.025 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:38:23.031 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:38:23.031 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:38:23.034 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:38:23.036 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:38:35.504 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:39:04.433 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:39:10.205 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:39:13.423 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:39:54.530 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:40:20.392 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:40:27.730 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:40:32.951 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:40:36.920 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:40:45.356 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.469 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.472 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.476 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.476 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:41:59.480 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.480 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:41:59.482 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.486 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:41:59.487 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:41:59.488 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:41:59.488 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:41:59.492 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:41:59.493 | INFO     | log_service:registrar_evento:164 - [job_004] WATCHER
2025-11-12 16:41:59.495 | INFO     | log_service:registrar_evento:164 - [job_004] WATCHER
2025-11-12 16:41:59.496 | ERROR    | watcher:process_job:162 - [job_004] Erro durante o processamento do job: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000021E23F82340>
    └ <Thread(ScriptRunner.scriptThread, started 18912)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000021E23F820C0>
    └ <Thread(ScriptRunner.scriptThread, started 18912)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 18912)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 18912)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='cb9e674c-3f21-4661-8d72-f26536c2209d', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 18912)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000021E2706ECF0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000021E270EDBC0>
    └ ScriptRunner(_session_id='cb9e674c-3f21-4661-8d72-f26536c2209d', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='cb9e674c-3f21-4661-8d72-f26536c2209d', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000021E27C01760>
        └ <function exec_func_with_error_handling at 0x0000021E270A0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000021E27C01760>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000021E269F29C0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000021E29D6C360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000021E59802160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_004')
    └ <function process_job at 0x0000021E598020C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/job_004')
              │         │      └ <function load_manifest at 0x0000021E29EA0FE0>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 236, in load_manifest
    LOGGER.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                 │                       │             └ <function PathBase.exists at 0x0000021E264E3880>
                                                 │                       └ WindowsPath('processing/job_004/manifest.json')
                                                 └ WindowsPath('processing/job_004/manifest.json')

NameError: name 'LOGGER' is not defined
2025-11-12 16:41:59.513 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: name 'LOGGER' is not defined
2025-11-12 16:42:19.533 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:42:19.534 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:42:19.539 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:42:19.540 | ERROR    | watcher:process_job:162 - [12] Erro durante o processamento do job: name 'LOGGER' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000021E23F82340>
    └ <Thread(ScriptRunner.scriptThread, started 18912)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000021E23F820C0>
    └ <Thread(ScriptRunner.scriptThread, started 18912)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 18912)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 18912)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='cb9e674c-3f21-4661-8d72-f26536c2209d', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 18912)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000021E2706ECF0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000021E270EDBC0>
    └ ScriptRunner(_session_id='cb9e674c-3f21-4661-8d72-f26536c2209d', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='cb9e674c-3f21-4661-8d72-f26536c2209d', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000021E27C01760>
        └ <function exec_func_with_error_handling at 0x0000021E270A0B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000021E27C01760>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000021E269F29C0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000021E29D6C360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000021E59802160>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12')
    └ <function process_job at 0x0000021E598020C0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/12')
              │         │      └ <function load_manifest at 0x0000021E29EA0FE0>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 236, in load_manifest
    LOGGER.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                 │                       │             └ <function PathBase.exists at 0x0000021E264E3880>
                                                 │                       └ WindowsPath('processing/12/manifest.json')
                                                 └ WindowsPath('processing/12/manifest.json')

NameError: name 'LOGGER' is not defined
2025-11-12 16:42:19.549 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: name 'LOGGER' is not defined
2025-11-12 16:51:02.956 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:51:02.963 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:51:02.967 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:51:02.967 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 16:51:02.971 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:51:02.971 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 16:51:02.974 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:51:02.979 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:51:02.979 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:51:02.981 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:51:02.981 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:52:38.097 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:52:38.097 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:52:38.100 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:52:38.101 | ERROR    | watcher:process_job:162 - [12] Erro durante o processamento do job: name '_logger' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001A77EBF2340>
    └ <Thread(ScriptRunner.scriptThread, started 17800)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001A77EBF20C0>
    └ <Thread(ScriptRunner.scriptThread, started 17800)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 17800)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 17800)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='83016aab-89fc-4d48-a824-2fa0e3cf8f78', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 17800)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001A701D4AC00>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001A701DCDBC0>
    └ ScriptRunner(_session_id='83016aab-89fc-4d48-a824-2fa0e3cf8f78', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='83016aab-89fc-4d48-a824-2fa0e3cf8f78', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001A7028E1760>
        └ <function exec_func_with_error_handling at 0x000001A701D84B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001A7028E1760>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001A70171D070, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001A704A4C360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001A7344F9EE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12')
    └ <function process_job at 0x000001A7344F9E40>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/12')
              │         │      └ <function load_manifest at 0x000001A704B64EA0>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 218, in load_manifest
    _logger.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                  │                       │             └ <function PathBase.exists at 0x000001A77FD43880>
                                                  │                       └ WindowsPath('processing/12/manifest.json')
                                                  └ WindowsPath('processing/12/manifest.json')

NameError: name '_logger' is not defined
2025-11-12 16:52:38.111 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: name '_logger' is not defined
2025-11-12 16:55:02.157 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:55:02.158 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:55:02.159 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:55:02.159 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:55:37.204 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:55:37.205 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:55:37.208 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:55:37.210 | ERROR    | watcher:process_job:162 - [12] Erro durante o processamento do job: name '_logger' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001A77EBF2340>
    └ <Thread(ScriptRunner.scriptThread, started 25052)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001A77EBF20C0>
    └ <Thread(ScriptRunner.scriptThread, started 25052)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 25052)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 25052)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='5400dac0-7992-4803-8baa-c3f83242d222', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 25052)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001A701D4AC00>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001A701DCDBC0>
    └ ScriptRunner(_session_id='5400dac0-7992-4803-8baa-c3f83242d222', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='5400dac0-7992-4803-8baa-c3f83242d222', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001A7344FB740>
        └ <function exec_func_with_error_handling at 0x000001A701D84B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001A7344FB740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001A724775D10, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001A7344FBB00>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001A7344F9EE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12')
    └ <function process_job at 0x000001A7344F9E40>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/12')
              │         │      └ <function load_manifest at 0x000001A704B64EA0>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 218, in load_manifest
    _logger.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                  │                       │             └ <function PathBase.exists at 0x000001A77FD43880>
                                                  │                       └ WindowsPath('processing/12/manifest.json')
                                                  └ WindowsPath('processing/12/manifest.json')

NameError: name '_logger' is not defined
2025-11-12 16:55:37.220 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: name '_logger' is not defined
2025-11-12 16:57:46.330 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 16:57:46.330 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 16:57:46.331 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 16:57:46.331 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 16:58:12.398 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 16:58:12.398 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:58:12.401 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 16:58:12.406 | ERROR    | watcher:process_job:162 - [12] Erro durante o processamento do job: name '_logger' is not defined
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001A77EBF2340>
    └ <Thread(ScriptRunner.scriptThread, started 25052)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001A77EBF20C0>
    └ <Thread(ScriptRunner.scriptThread, started 25052)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 25052)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 25052)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='5400dac0-7992-4803-8baa-c3f83242d222', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 25052)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001A701D4AC00>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001A701DCDBC0>
    └ ScriptRunner(_session_id='5400dac0-7992-4803-8baa-c3f83242d222', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='5400dac0-7992-4803-8baa-c3f83242d222', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001A7344FB740>
        └ <function exec_func_with_error_handling at 0x000001A701D84B80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001A7344FB740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001A724775D10, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001A7344FBB00>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001A7344F9EE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12')
    └ <function process_job at 0x000001A7344F9E40>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/12')
              │         │      └ <function load_manifest at 0x000001A704B64EA0>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 218, in load_manifest
    _logger.info(f"[MANIFEST] Tentando carregar: {manifest_path} (exists={manifest_path.exists()})")
                                                  │                       │             └ <function PathBase.exists at 0x000001A77FD43880>
                                                  │                       └ WindowsPath('processing/12/manifest.json')
                                                  └ WindowsPath('processing/12/manifest.json')

NameError: name '_logger' is not defined
2025-11-12 16:58:12.416 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: name '_logger' is not defined
2025-11-12 17:00:57.233 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:00:57.236 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:00:57.239 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:00:57.239 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 17:00:57.242 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:00:57.242 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 17:00:57.244 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:00:57.248 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:00:57.248 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 17:00:57.249 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 17:00:57.249 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 17:01:13.374 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:01:13.375 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 17:01:13.376 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 17:01:13.377 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 17:01:42.292 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-12 17:01:42.292 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 17:01:42.295 | INFO     | log_service:registrar_evento:164 - [12] WATCHER
2025-11-12 17:01:42.296 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\12\manifest.json (exists=True)
2025-11-12 17:01:42.300 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-12 17:01:42.303 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/12' → 'manifest.normalizado.json'
2025-11-12 17:01:42.304 | WARNING  | watcher:process_job:121 - [12] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-11-12 17:01:42.305 | INFO     | watcher:process_job:124 - [12] Iniciando OCR/Docling…
2025-11-12 17:01:42.307 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-12 17:02:28.084 | WARNING  | extrator_docling:extrair_com_docling:122 - Docling falhou: [WinError 1314] O cliente não tem o privilégio necessário: '..\\..\\blobs\\a6344aac8c09253b3b630fb776ae94478aa0275b' -> 'C:\\Users\\walte\\.cache\\huggingface\\hub\\models--docling-project--docling-layout-heron\\snapshots\\bdb7099d742220552d703932cc0ce0a26a7a8da8\\.gitattributes'
2025-11-12 17:02:38.330 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Tesseract
2025-11-12 17:02:38.332 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-12 17:03:18.644 | WARNING  | extrator_docling:extrair_com_docling:122 - Docling falhou: [WinError 1314] O cliente não tem o privilégio necessário: '..\\..\\blobs\\575b058b45230d48a06df9b1944f4bd40949db1d' -> 'C:\\Users\\walte\\.cache\\huggingface\\hub\\models--docling-project--docling-models\\snapshots\\fc0f2d45e2218ea24bce5045f58a389aed16dc23\\.gitattributes'
2025-11-12 17:03:59.402 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Tesseract
2025-11-12 17:03:59.404 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-11-12 17:04:35.833 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-11-12 17:04:35.835 | INFO     | watcher:process_job:126 - [12] OCR/Docling concluído: OK
2025-11-12 17:04:35.836 | INFO     | watcher:process_job:129 - [12] Iniciando IA Validador 1…
2025-11-12 17:04:35.841 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-12 17:05:12.244 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para 12 (padrao)
2025-11-12 17:05:12.246 | INFO     | watcher:process_job:131 - [12] IA1 concluída: OK
2025-11-12 17:05:12.246 | INFO     | watcher:process_job:134 - [12] Consultando dados ReceitaWS…
2025-11-12 17:05:12.248 | INFO     | watcher:_stage_manifest_for_serpro:92 - [12] Manifest staged para ReceitaWS: outbox/12/serpro/manifest_for_serpro.json
2025-11-12 17:05:13.292 | INFO     | watcher:process_job:140 - [12] ReceitaWS concluída: OK
2025-11-12 17:05:13.292 | INFO     | watcher:process_job:143 - [12] Iniciando IA Validador 2 (comparativa)…
2025-11-12 17:05:13.295 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-12 17:05:42.261 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para 12 (comparativo)
2025-11-12 17:05:42.263 | INFO     | watcher:process_job:150 - [12] IA2 concluída: OK
2025-11-12 17:05:42.265 | INFO     | watcher:process_job:153 - [12] Gerando relatório final…
2025-11-12 17:05:42.274 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\12\resultado
2025-11-12 17:05:42.274 | INFO     | watcher:process_job:155 - [12] Relatório final gerado.
2025-11-12 17:05:42.277 | ERROR    | watcher:process_job:162 - [12] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001CE1D3F2340>
    └ <Thread(ScriptRunner.scriptThread, started 18572)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001CE1D3F20C0>
    └ <Thread(ScriptRunner.scriptThread, started 18572)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 18572)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 18572)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='912cff0c-feba-4505-a85b-5c06bd75ea09', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 18572)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001CE20532ED0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x000001CE205ADBC0>
    └ ScriptRunner(_session_id='912cff0c-feba-4505-a85b-5c06bd75ea09', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='912cff0c-feba-4505-a85b-5c06bd75ea09', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE210C1760>
        └ <function exec_func_with_error_handling at 0x000001CE2055CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001CE210C1760>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001CE1FDFB0D0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001CE231DC360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001CE52CADEE0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11/12')
    └ <function process_job at 0x000001CE52CADE40>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ '12'
    └ <function registrar_evento at 0x000001CE2212E160>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-11-12 17:05:42.284 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
2025-11-12 17:14:58.923 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.927 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.931 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.932 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 17:14:58.935 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.936 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 17:14:58.939 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.945 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.945 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 17:14:58.946 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:14:58.946 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 17:14:58.948 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 17:14:58.948 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 17:14:58.950 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 17:14:58.951 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 17:17:02.570 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:17:02.575 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:17:02.579 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:17:02.579 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 17:17:02.582 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:17:02.582 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 17:17:02.584 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:17:02.586 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:18:23.612 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:18:33.098 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:18:40.748 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:18:43.955 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:18:58.706 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:21:23.211 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:21:33.576 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:21:36.114 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:21:43.710 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:21:48.526 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:21:50.210 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.956 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.960 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.963 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.963 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 17:23:40.966 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.966 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 17:23:40.968 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.972 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 17:23:40.972 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 17:23:40.973 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 17:23:40.974 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-12 17:23:40.977 | INFO     | watcher:detect_and_move_jobs:175 - 2 job(s) detectado(s) em /inbox.
2025-11-12 17:23:40.977 | INFO     | log_service:registrar_evento:164 - [job_005] WATCHER
2025-11-12 17:23:40.980 | INFO     | log_service:registrar_evento:164 - [job_005] WATCHER
2025-11-12 17:23:40.981 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_005\manifest.json (exists=True)
2025-11-12 17:23:40.984 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-12 17:23:40.986 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_005' → 'manifest.normalizado.json'
2025-11-12 17:23:40.987 | WARNING  | watcher:process_job:121 - [job_005] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-11-12 17:23:40.987 | INFO     | watcher:process_job:124 - [job_005] Iniciando OCR/Docling…
2025-11-12 17:23:40.989 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-12 17:23:46.283 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-12 17:23:46.284 | INFO     | watcher:process_job:126 - [job_005] OCR/Docling concluído: OK
2025-11-12 17:23:46.285 | INFO     | watcher:process_job:129 - [job_005] Iniciando IA Validador 1…
2025-11-12 17:23:46.289 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-12 17:24:01.940 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_005 (padrao)
2025-11-12 17:24:01.941 | INFO     | watcher:process_job:131 - [job_005] IA1 concluída: OK
2025-11-12 17:24:01.942 | INFO     | watcher:process_job:134 - [job_005] Consultando dados ReceitaWS…
2025-11-12 17:24:01.946 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_005] Manifest staged para ReceitaWS: outbox/job_005/serpro/manifest_for_serpro.json
2025-11-12 17:24:03.177 | INFO     | watcher:process_job:140 - [job_005] ReceitaWS concluída: OK
2025-11-12 17:24:03.178 | INFO     | watcher:process_job:143 - [job_005] Iniciando IA Validador 2 (comparativa)…
2025-11-12 17:24:03.179 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-11-12 17:24:20.054 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_005 (comparativo)
2025-11-12 17:24:20.056 | INFO     | watcher:process_job:150 - [job_005] IA2 concluída: OK
2025-11-12 17:24:20.056 | INFO     | watcher:process_job:153 - [job_005] Gerando relatório final…
2025-11-12 17:24:20.065 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_005\resultado
2025-11-12 17:24:20.066 | INFO     | watcher:process_job:155 - [job_005] Relatório final gerado.
2025-11-12 17:24:20.068 | ERROR    | watcher:process_job:162 - [job_005] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023480D02340>
    └ <Thread(ScriptRunner.scriptThread, started 21884)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023480D020C0>
    └ <Thread(ScriptRunner.scriptThread, started 21884)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21884)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21884)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='1d8d65bc-b1ae-464d-b7a4-083be2e8f19f', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21884)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000023483DE2F20>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000023483E5DBC0>
    └ ScriptRunner(_session_id='1d8d65bc-b1ae-464d-b7a4-083be2e8f19f', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='1d8d65bc-b1ae-464d-b7a4-083be2e8f19f', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000023484975760>
        └ <function exec_func_with_error_handling at 0x0000023483E0CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000023484975760>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x00000234829ED780, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000023486ACC360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x00000234B6599E40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_005')
    └ <function process_job at 0x00000234B6599DA0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ 'job_005'
    └ <function registrar_evento at 0x00000234859E2160>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-11-12 17:24:20.072 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
2025-11-12 17:24:20.072 | INFO     | log_service:registrar_evento:164 - [11] WATCHER
2025-11-12 17:24:20.082 | INFO     | log_service:registrar_evento:164 - [11] WATCHER
2025-11-12 17:24:20.084 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\11\manifest.json (exists=True)
2025-11-12 17:24:20.086 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-12 17:24:20.087 | ERROR    | watcher:process_job:162 - [11] Erro durante o processamento do job: Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000023480D02340>
    └ <Thread(ScriptRunner.scriptThread, started 21884)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000023480D020C0>
    └ <Thread(ScriptRunner.scriptThread, started 21884)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 21884)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 21884)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='1d8d65bc-b1ae-464d-b7a4-083be2e8f19f', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 21884)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000023483DE2F20>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000023483E5DBC0>
    └ ScriptRunner(_session_id='1d8d65bc-b1ae-464d-b7a4-083be2e8f19f', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='1d8d65bc-b1ae-464d-b7a4-083be2e8f19f', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000023484975760>
        └ <function exec_func_with_error_handling at 0x0000023483E0CB80>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000023484975760>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x00000234829ED780, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000023486ACC360>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x00000234B6599E40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/2025/11')
    └ <function process_job at 0x00000234B6599DA0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 117, in process_job
    manifest: Dict[str, Any] = load_manifest(processing_dir, strict_files=True)
              │         │      │             └ WindowsPath('processing/11')
              │         │      └ <function load_manifest at 0x0000023486BE8EA0>
              │         └ typing.Any
              └ typing.Dict

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\manifest_loader.py", line 250, in load_manifest
    raise RuntimeError(msg)
                       └ "Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']"

RuntimeError: Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']
2025-11-12 17:24:20.092 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: Arquivos listados no manifest não encontrados: ['ii_alteracao_contratual_bmf_turismo.pdf', 'fernando_de_lima_vila_nova.pdf']
2025-11-12 19:57:15.057 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 19:57:15.067 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 19:57:15.075 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 19:57:15.076 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-12 19:57:15.089 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 19:57:15.089 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-12 19:57:15.094 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 19:57:15.100 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-12 19:57:15.101 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-12 19:57:15.103 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-12 19:57:15.104 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-13 06:50:12.533 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-13 06:50:12.542 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-13 06:50:12.552 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-13 06:50:12.553 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-13 06:50:12.562 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-13 06:50:12.563 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-13 06:50:12.569 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-13 06:50:12.576 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-13 06:50:12.576 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-13 06:50:12.581 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-13 06:50:12.582 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-13 06:58:47.848 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-13 06:58:47.874 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_006] WATCHER
2025-11-13 06:58:47.890 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_006] WATCHER
2025-11-13 06:58:47.896 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_006\manifest.json (exists=True)
2025-11-13 06:58:47.912 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-13 06:58:47.960 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_006' → 'manifest.normalizado.json'
2025-11-13 06:58:47.963 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_006] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-11-13 06:58:47.964 | INFO     | watcher:process_job:124 - [job_bmf_turismo_006] Iniciando OCR/Docling…
2025-11-13 06:58:47.968 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-13 06:59:03.028 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-13 06:59:03.031 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-14 12:06:59.849 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 12:06:59.860 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 12:06:59.869 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 12:06:59.870 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-14 12:06:59.877 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 12:06:59.878 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-14 12:06:59.881 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 12:06:59.887 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 12:06:59.888 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-14 12:06:59.891 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-14 12:06:59.891 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-14 12:07:49.925 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-14 12:07:49.925 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-11-14 12:07:49.930 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-11-14 12:07:49.933 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_003\manifest.json (exists=True)
2025-11-14 12:07:49.936 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-11-14 12:07:49.940 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_003' → 'manifest.normalizado.json'
2025-11-14 12:07:49.943 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_003] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-11-14 12:07:49.943 | INFO     | watcher:process_job:124 - [job_bmf_turismo_003] Iniciando OCR/Docling…
2025-11-14 12:07:49.945 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-11-14 12:08:04.685 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-11-14 12:08:04.686 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-11-14 13:49:03.441 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 13:49:03.449 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 13:49:03.456 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 13:49:03.456 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-14 13:49:03.465 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 13:49:03.466 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-14 13:49:03.469 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 13:49:03.474 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-14 13:49:03.476 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-14 13:49:03.480 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-14 13:49:03.481 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-14 14:09:09.267 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-14 14:09:09.270 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-11-23 08:11:02.412 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:02.418 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:02.423 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:02.424 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-11-23 08:11:02.429 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:02.430 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-11-23 08:11:02.433 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:02.438 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:02.439 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-23 08:11:02.441 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-23 08:11:02.441 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-23 08:11:02.444 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-23 08:11:02.445 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-11-23 08:11:28.944 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:28.945 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-23 08:11:28.946 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-23 08:11:28.946 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-23 08:11:28.948 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-23 08:11:28.949 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-11-23 08:11:47.005 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:47.007 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-23 08:11:47.010 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-23 08:11:47.011 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-23 08:11:47.014 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-23 08:11:47.014 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-11-23 08:11:57.060 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-11-23 08:11:57.060 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-11-23 08:11:57.061 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-11-23 08:11:57.062 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-11-23 08:11:57.066 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-11-23 08:11:57.066 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_003] WATCHER
2025-12-03 11:34:06.780 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 11:34:06.788 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 11:34:06.792 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 11:34:06.792 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-03 11:34:06.798 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 11:34:06.798 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-03 11:34:06.801 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 11:34:06.805 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 11:34:06.806 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-12-03 11:34:06.809 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-12-03 11:34:06.810 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-12-03 11:34:06.821 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-03 11:34:06.823 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_998] WATCHER
2025-12-03 11:34:06.833 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_998] WATCHER
2025-12-03 11:34:06.835 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_998\manifest.json (exists=True)
2025-12-03 11:34:06.838 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-12-03 11:34:06.842 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_998' → 'manifest.normalizado.json'
2025-12-03 11:34:06.843 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_998] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-12-03 11:34:06.844 | INFO     | watcher:process_job:124 - [job_bmf_turismo_998] Iniciando OCR/Docling…
2025-12-03 11:34:06.846 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-12-03 11:35:21.938 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-12-03 11:35:21.940 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-12-03 11:38:34.895 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-12-03 11:38:34.898 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-12-03 11:39:12.287 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-12-03 11:39:12.288 | INFO     | watcher:process_job:126 - [job_bmf_turismo_998] OCR/Docling concluído: OK
2025-12-03 11:39:12.288 | INFO     | watcher:process_job:129 - [job_bmf_turismo_998] Iniciando IA Validador 1…
2025-12-03 11:39:12.291 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-03 11:39:49.445 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_998 (padrao)
2025-12-03 11:39:49.446 | INFO     | watcher:process_job:131 - [job_bmf_turismo_998] IA1 concluída: OK
2025-12-03 11:39:49.447 | INFO     | watcher:process_job:134 - [job_bmf_turismo_998] Consultando dados ReceitaWS…
2025-12-03 11:39:49.449 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_bmf_turismo_998] Manifest staged para ReceitaWS: outbox/job_bmf_turismo_998/serpro/manifest_for_serpro.json
2025-12-03 11:39:50.914 | INFO     | watcher:process_job:140 - [job_bmf_turismo_998] ReceitaWS concluída: OK
2025-12-03 11:39:50.915 | INFO     | watcher:process_job:143 - [job_bmf_turismo_998] Iniciando IA Validador 2 (comparativa)…
2025-12-03 11:39:50.919 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-03 11:40:28.070 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_998 (comparativo)
2025-12-03 11:40:28.071 | INFO     | watcher:process_job:150 - [job_bmf_turismo_998] IA2 concluída: OK
2025-12-03 11:40:28.072 | INFO     | watcher:process_job:153 - [job_bmf_turismo_998] Gerando relatório final…
2025-12-03 11:40:28.080 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_998\resultado
2025-12-03 11:40:28.081 | INFO     | watcher:process_job:155 - [job_bmf_turismo_998] Relatório final gerado.
2025-12-03 11:40:28.084 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_998] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x0000025A41F42340>
    └ <Thread(ScriptRunner.scriptThread, started 24104)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x0000025A41F420C0>
    └ <Thread(ScriptRunner.scriptThread, started 24104)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 24104)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 24104)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='75bc0086-c14a-4882-a843-3a9129447046', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 24104)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x0000025A448729D0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x0000025A454645E0>
    └ ScriptRunner(_session_id='75bc0086-c14a-4882-a843-3a9129447046', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='75bc0086-c14a-4882-a843-3a9129447046', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000025A45CA80E0>
        └ <function exec_func_with_error_handling at 0x0000025A453DF740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x0000025A45CA80E0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x0000025A44E121D0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x0000025A47DAEAC0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x0000025A77839120>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_bmf_turismo_998')
    └ <function process_job at 0x0000025A77839080>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ 'job_bmf_turismo_998'
    └ <function registrar_evento at 0x0000025A46D3C7C0>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-12-03 11:40:28.091 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
2025-12-03 13:23:31.523 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:23:31.533 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:23:31.541 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:23:31.542 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-03 13:23:31.550 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:23:31.551 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-03 13:23:31.556 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:23:31.561 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:24:09.997 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:24:55.712 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:25:04.395 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:25:21.850 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:27:00.080 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:27:49.419 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:27:56.438 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:28:03.645 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:28:37.413 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:28:39.012 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:28:41.180 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:28:58.235 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:29:05.418 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:30:53.044 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:32:03.470 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:32:10.361 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:32:12.008 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:32:33.501 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:32:54.235 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:33:00.636 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:33:03.821 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-03 13:33:07.014 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.033 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.037 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.040 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.040 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-05 09:55:50.043 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.043 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-05 09:55:50.044 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.047 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:55:50.047 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-12-05 09:55:50.048 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-12-05 09:55:50.048 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-12-05 09:55:50.049 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-05 09:55:50.049 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_997] WATCHER
2025-12-05 09:55:50.051 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_997] WATCHER
2025-12-05 09:55:50.052 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_997\manifest.json (exists=True)
2025-12-05 09:55:50.054 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-12-05 09:55:50.057 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_997' → 'manifest.normalizado.json'
2025-12-05 09:55:50.058 | INFO     | watcher:process_job:124 - [job_bmf_turismo_997] Iniciando OCR/Docling…
2025-12-05 09:55:50.059 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-12-05 09:56:00.666 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-12-05 09:56:00.667 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-12-05 09:57:54.775 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.777 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.779 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.779 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-05 09:57:54.781 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.781 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-05 09:57:54.783 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.789 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.789 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 09:57:54.789 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-12-05 09:57:54.790 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-12-05 09:57:54.791 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-12-05 09:57:54.792 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-12-05 09:57:54.792 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-12-05 09:57:54.792 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-12-05 10:18:25.293 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-05 10:18:25.294 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_996] WATCHER
2025-12-05 10:18:25.296 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-05 10:18:25.296 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_996] WATCHER
2025-12-05 10:18:25.299 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_996] WATCHER
2025-12-05 10:18:25.300 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_996\manifest.json (exists=True)
2025-12-05 10:18:25.303 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-12-05 10:18:25.310 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_996' → 'manifest.normalizado.json'
2025-12-05 10:18:25.314 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_996] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-12-05 10:18:25.315 | INFO     | watcher:process_job:124 - [job_bmf_turismo_996] Iniciando OCR/Docling…
2025-12-05 10:18:25.320 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de cartao_cnpj.pdf
2025-12-05 10:18:41.637 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: cartao_cnpj.pdf via Docling
2025-12-05 10:18:41.640 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de ii_alteracao_contratual_bmf_turismo.pdf
2025-12-05 10:26:33.353 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: ii_alteracao_contratual_bmf_turismo.pdf via Docling
2025-12-05 10:26:33.357 | INFO     | extrator_docling:executar_ocr:59 - Iniciando extração de fernando_de_lima_vila_nova.pdf
2025-12-05 10:29:13.065 | INFO     | extrator_docling:executar_ocr:85 - Extração concluída: fernando_de_lima_vila_nova.pdf via Docling
2025-12-05 10:29:13.068 | INFO     | watcher:process_job:126 - [job_bmf_turismo_996] OCR/Docling concluído: OK
2025-12-05 10:29:13.070 | INFO     | watcher:process_job:129 - [job_bmf_turismo_996] Iniciando IA Validador 1…
2025-12-05 10:29:13.075 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 10:29:54.723 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_996 (padrao)
2025-12-05 10:29:54.724 | INFO     | watcher:process_job:131 - [job_bmf_turismo_996] IA1 concluída: OK
2025-12-05 10:29:54.725 | INFO     | watcher:process_job:134 - [job_bmf_turismo_996] Consultando dados ReceitaWS…
2025-12-05 10:29:54.731 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_bmf_turismo_996] Manifest staged para ReceitaWS: outbox/job_bmf_turismo_996/serpro/manifest_for_serpro.json
2025-12-05 10:29:58.161 | INFO     | watcher:process_job:140 - [job_bmf_turismo_996] ReceitaWS concluída: OK
2025-12-05 10:29:58.163 | INFO     | watcher:process_job:143 - [job_bmf_turismo_996] Iniciando IA Validador 2 (comparativa)…
2025-12-05 10:29:58.167 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 10:30:29.491 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_996 (comparativo)
2025-12-05 10:30:29.496 | INFO     | watcher:process_job:150 - [job_bmf_turismo_996] IA2 concluída: OK
2025-12-05 10:30:29.496 | INFO     | watcher:process_job:153 - [job_bmf_turismo_996] Gerando relatório final…
2025-12-05 10:30:29.519 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_996\resultado
2025-12-05 10:30:29.523 | INFO     | watcher:process_job:155 - [job_bmf_turismo_996] Relatório final gerado.
2025-12-05 10:30:29.533 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_996] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000180E0B72340>
    └ <Thread(ScriptRunner.scriptThread, started 19124)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x00000180E0B720C0>
    └ <Thread(ScriptRunner.scriptThread, started 19124)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 19124)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 19124)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='2fab3e76-3efd-443e-b81c-cc5bc53b77e0', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 19124)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x00000180E3352B60>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x00000180E3F445E0>
    └ ScriptRunner(_session_id='2fab3e76-3efd-443e-b81c-cc5bc53b77e0', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='2fab3e76-3efd-443e-b81c-cc5bc53b77e0', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000180E47C3CE0>
        └ <function exec_func_with_error_handling at 0x00000180E3EBF740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000180E47C3CE0>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x00000180E3954230, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001809672D620>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001809672D580>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_bmf_turismo_996')
    └ <function process_job at 0x000001809672D4E0>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ 'job_bmf_turismo_996'
    └ <function registrar_evento at 0x00000180E588C400>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 10:30:29.566 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 11:47:35.560 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 11:47:56.041 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 11:47:56.043 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 11:47:56.045 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 11:47:56.047 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 11:47:56.047 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-05 11:47:56.050 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 11:47:56.050 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-05 11:47:56.052 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:31:24.330 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.560 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.565 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.572 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.578 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.578 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-05 14:32:02.587 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.588 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-05 14:32:02.592 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.597 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 14:32:02.597 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-12-05 14:32:02.599 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-12-05 14:32:02.599 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-12-05 14:32:17.606 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-05 14:32:17.606 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_995] WATCHER
2025-12-05 14:32:17.612 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_995] WATCHER
2025-12-05 14:32:17.614 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_995\manifest.json (exists=True)
2025-12-05 14:32:17.621 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-12-05 14:32:17.625 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_995' → 'manifest.normalizado.json'
2025-12-05 14:32:17.626 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_995] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-12-05 14:32:17.626 | INFO     | watcher:process_job:124 - [job_bmf_turismo_995] Iniciando OCR/Docling…
2025-12-05 14:32:17.627 | INFO     | ocr_router:executar_ocr:28 - Iniciando OCR para 3 arquivos.
2025-12-05 14:32:17.628 | INFO     | ocr_router:executar_ocr:63 - Roteando cartao_cnpj.pdf para Pipeline Padrão (Docling).
2025-12-05 14:32:31.858 | INFO     | ocr_router:executar_ocr:63 - Roteando ii_alteracao_contratual_bmf_turismo.pdf para Pipeline Padrão (Docling).
2025-12-05 14:36:16.275 | INFO     | ocr_router:executar_ocr:63 - Roteando fernando_de_lima_vila_nova.pdf para Pipeline Padrão (Docling).
2025-12-05 14:37:07.483 | INFO     | watcher:process_job:126 - [job_bmf_turismo_995] OCR/Docling concluído: OK
2025-12-05 14:37:07.484 | INFO     | watcher:process_job:129 - [job_bmf_turismo_995] Iniciando IA Validador 1…
2025-12-05 14:37:07.489 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 14:37:40.013 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_995 (padrao)
2025-12-05 14:37:40.013 | INFO     | watcher:process_job:131 - [job_bmf_turismo_995] IA1 concluída: OK
2025-12-05 14:37:40.014 | INFO     | watcher:process_job:134 - [job_bmf_turismo_995] Consultando dados ReceitaWS…
2025-12-05 14:37:40.016 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_bmf_turismo_995] Manifest staged para ReceitaWS: outbox/job_bmf_turismo_995/serpro/manifest_for_serpro.json
2025-12-05 14:37:41.186 | INFO     | watcher:process_job:140 - [job_bmf_turismo_995] ReceitaWS concluída: OK
2025-12-05 14:37:41.186 | INFO     | watcher:process_job:143 - [job_bmf_turismo_995] Iniciando IA Validador 2 (comparativa)…
2025-12-05 14:37:41.188 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 14:38:06.609 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_995 (comparativo)
2025-12-05 14:38:06.609 | INFO     | watcher:process_job:150 - [job_bmf_turismo_995] IA2 concluída: OK
2025-12-05 14:38:06.609 | INFO     | watcher:process_job:153 - [job_bmf_turismo_995] Gerando relatório final…
2025-12-05 14:38:06.615 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_995\resultado
2025-12-05 14:38:06.616 | INFO     | watcher:process_job:155 - [job_bmf_turismo_995] Relatório final gerado.
2025-12-05 14:38:06.618 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_995] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001EE37322340>
    └ <Thread(ScriptRunner.scriptThread, started 33336)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001EE373220C0>
    └ <Thread(ScriptRunner.scriptThread, started 33336)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 33336)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 33336)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='04c7e816-c997-4cf2-a142-a643609d432d', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 33336)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001EE39B92C50>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001EE3A7845E0>
    └ ScriptRunner(_session_id='04c7e816-c997-4cf2-a142-a643609d432d', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='04c7e816-c997-4cf2-a142-a643609d432d', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001EE3AFC4180>
        └ <function exec_func_with_error_handling at 0x000001EE3A6FF740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001EE3AFC4180>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001EE38DD3420, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001EE3D0ADE40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001EE6D6A34C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_bmf_turismo_995')
    └ <function process_job at 0x000001EE6D6A3420>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ 'job_bmf_turismo_995'
    └ <function registrar_evento at 0x000001EE3C038860>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 14:38:06.623 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 14:47:11.829 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-05 14:47:11.830 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_994] WATCHER
2025-12-05 14:47:11.833 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_994] WATCHER
2025-12-05 14:47:11.834 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_994\manifest.json (exists=True)
2025-12-05 14:47:11.836 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-12-05 14:47:11.843 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_994' → 'manifest.normalizado.json'
2025-12-05 14:47:11.843 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_994] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-12-05 14:47:11.843 | INFO     | watcher:process_job:124 - [job_bmf_turismo_994] Iniciando OCR/Docling…
2025-12-05 14:47:11.844 | INFO     | ocr_router:executar_ocr:28 - Iniciando OCR para 3 arquivos.
2025-12-05 14:47:11.846 | INFO     | ocr_router:executar_ocr:63 - Roteando cartao_cnpj.pdf para Pipeline Padrão (Docling).
2025-12-05 14:47:13.637 | WARNING  | extrator_docling:extrair_com_docling:122 - Docling falhou: cannot schedule new futures after interpreter shutdown
2025-12-05 14:47:16.970 | INFO     | ocr_router:executar_ocr:63 - Roteando ii_alteracao_contratual_bmf_turismo.pdf para Pipeline Padrão (Docling).
2025-12-05 14:47:18.388 | WARNING  | extrator_docling:extrair_com_docling:122 - Docling falhou: cannot schedule new futures after interpreter shutdown
2025-12-05 14:47:51.898 | INFO     | ocr_router:executar_ocr:42 - Roteando fernando_de_lima_vila_nova.pdf para CNH OCR.
2025-12-05 14:47:52.525 | INFO     | cnh_ocr:process_cnh:75 - Processando página 1 de processing\job_bmf_turismo_994\fernando_de_lima_vila_nova.pdf
2025-12-05 14:47:54.929 | INFO     | ledger:register_entry:68 - Ledger atualizado: job_bmf_turismo_994/a3 (OCR_CNH) → OK
2025-12-05 14:47:54.938 | INFO     | watcher:process_job:126 - [job_bmf_turismo_994] OCR/Docling concluído: OK
2025-12-05 14:47:54.939 | INFO     | watcher:process_job:129 - [job_bmf_turismo_994] Iniciando IA Validador 1…
2025-12-05 14:47:54.942 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 14:48:25.408 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_994 (padrao)
2025-12-05 14:48:25.409 | INFO     | watcher:process_job:131 - [job_bmf_turismo_994] IA1 concluída: OK
2025-12-05 14:48:25.409 | INFO     | watcher:process_job:134 - [job_bmf_turismo_994] Consultando dados ReceitaWS…
2025-12-05 14:48:25.412 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_bmf_turismo_994] Manifest staged para ReceitaWS: outbox/job_bmf_turismo_994/serpro/manifest_for_serpro.json
2025-12-05 14:48:26.379 | INFO     | watcher:process_job:140 - [job_bmf_turismo_994] ReceitaWS concluída: OK
2025-12-05 14:48:26.379 | INFO     | watcher:process_job:143 - [job_bmf_turismo_994] Iniciando IA Validador 2 (comparativa)…
2025-12-05 14:48:26.381 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 14:48:54.509 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_994 (comparativo)
2025-12-05 14:48:54.511 | INFO     | watcher:process_job:150 - [job_bmf_turismo_994] IA2 concluída: OK
2025-12-05 14:48:54.511 | INFO     | watcher:process_job:153 - [job_bmf_turismo_994] Gerando relatório final…
2025-12-05 14:48:54.524 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_994\resultado
2025-12-05 14:48:54.524 | INFO     | watcher:process_job:155 - [job_bmf_turismo_994] Relatório final gerado.
2025-12-05 14:48:54.528 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_994] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x000001EE37322340>
    └ <Thread(ScriptRunner.scriptThread, started 33336)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x000001EE373220C0>
    └ <Thread(ScriptRunner.scriptThread, started 33336)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 33336)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 33336)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='04c7e816-c997-4cf2-a142-a643609d432d', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 33336)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x000001EE39B92C50>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, context_info=timezone: "America/...
    │    └ <function ScriptRunner._run_script at 0x000001EE3A7845E0>
    └ ScriptRunner(_session_id='04c7e816-c997-4cf2-a142-a643609d432d', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='04c7e816-c997-4cf2-a142-a643609d432d', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001EE3AFC4180>
        └ <function exec_func_with_error_handling at 0x000001EE3A6FF740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x000001EE3AFC4180>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x000001EE38DD3420, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x000001EE3D0ADE40>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x000001EE6D6A34C0>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_bmf_turismo_994')
    └ <function process_job at 0x000001EE6D6A3420>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ 'job_bmf_turismo_994'
    └ <function registrar_evento at 0x000001EE3C038860>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 14:48:54.532 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 15:00:58.689 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.251 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.254 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.258 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.263 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.263 | INFO     | consulta_serpro:<module>:20 - ReceitaWS MODE ATIVO — consulta_serpro.py (build 2025-11-05) | file=%s
2025-12-05 15:01:15.268 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.268 | INFO     | watcher:<module>:20 - watcher.py carregado de: C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py
2025-12-05 15:01:15.271 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.277 | INFO     | log_service:init_folders:119 - Estrutura de diretórios inicializada com sucesso.
2025-12-05 15:01:15.278 | INFO     | __main__:main:143 - Estrutura de diretórios verificada:
2025-12-05 15:01:15.279 | INFO     | __main__:main:154 - Modo PRODUÇÃO - monitoramento contínuo iniciado.
2025-12-05 15:01:15.280 | INFO     | watcher:detect_and_move_jobs:171 - Iniciando monitoramento do diretório /inbox …
2025-12-05 15:01:45.292 | INFO     | watcher:detect_and_move_jobs:175 - 1 job(s) detectado(s) em /inbox.
2025-12-05 15:01:45.293 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_994] WATCHER
2025-12-05 15:01:45.295 | INFO     | log_service:registrar_evento:164 - [job_bmf_turismo_994] WATCHER
2025-12-05 15:01:45.296 | INFO     | manifest_loader:load_manifest:218 - [MANIFEST] Tentando carregar: processing\job_bmf_turismo_994\manifest.json (exists=True)
2025-12-05 15:01:45.298 | INFO     | manifest_loader:_load_external_schema_if_exists:82 - Schema externo encontrado em schemas/manifest_v3.json
2025-12-05 15:01:45.301 | INFO     | manifest_loader:load_manifest:256 - Manifest carregado e normalizado para job_dir='processing/job_bmf_turismo_994' → 'manifest.normalizado.json'
2025-12-05 15:01:45.303 | WARNING  | watcher:process_job:121 - [job_bmf_turismo_994] job_id no manifest difere do nome da pasta. Prosseguindo assim mesmo.
2025-12-05 15:01:45.305 | INFO     | watcher:process_job:124 - [job_bmf_turismo_994] Iniciando OCR/Docling…
2025-12-05 15:01:45.306 | INFO     | ocr_router:executar_ocr:28 - Iniciando OCR para 3 arquivos.
2025-12-05 15:01:45.307 | INFO     | ocr_router:executar_ocr:71 - Roteando cartao_cnpj.pdf para Pipeline Padrão (Docling).
2025-12-05 15:01:51.445 | INFO     | ocr_router:executar_ocr:71 - Roteando ii_alteracao_contratual_bmf_turismo.pdf para Pipeline Padrão (Docling).
2025-12-05 15:06:12.422 | INFO     | ocr_router:executar_ocr:50 - Roteando fernando_de_lima_vila_nova.pdf para CNH OCR.
2025-12-05 15:06:13.140 | INFO     | cnh_ocr:process_cnh:75 - Processando página 1 de processing\job_bmf_turismo_994\fernando_de_lima_vila_nova.pdf
2025-12-05 15:06:15.537 | INFO     | ledger:register_entry:68 - Ledger atualizado: job_bmf_turismo_994/a3 (OCR_CNH) → OK
2025-12-05 15:06:15.553 | INFO     | watcher:process_job:126 - [job_bmf_turismo_994] OCR/Docling concluído: OK
2025-12-05 15:06:15.554 | INFO     | watcher:process_job:129 - [job_bmf_turismo_994] Iniciando IA Validador 1…
2025-12-05 15:06:15.558 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 15:06:48.309 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_994 (padrao)
2025-12-05 15:06:48.311 | INFO     | watcher:process_job:131 - [job_bmf_turismo_994] IA1 concluída: OK
2025-12-05 15:06:48.312 | INFO     | watcher:process_job:134 - [job_bmf_turismo_994] Consultando dados ReceitaWS…
2025-12-05 15:06:48.315 | INFO     | watcher:_stage_manifest_for_serpro:92 - [job_bmf_turismo_994] Manifest staged para ReceitaWS: outbox/job_bmf_turismo_994/serpro/manifest_for_serpro.json
2025-12-05 15:06:49.778 | INFO     | watcher:process_job:140 - [job_bmf_turismo_994] ReceitaWS concluída: OK
2025-12-05 15:06:49.780 | INFO     | watcher:process_job:143 - [job_bmf_turismo_994] Iniciando IA Validador 2 (comparativa)…
2025-12-05 15:06:49.784 | INFO     | doc_verifier_agent:validar_documentos_openai:64 - Enviando análise para OpenAI (PJ)...
2025-12-05 15:07:18.975 | INFO     | doc_verifier_agent:validar_documentos_openai:97 - Validação IA concluída para job_bmf_turismo_994 (comparativo)
2025-12-05 15:07:18.976 | INFO     | watcher:process_job:150 - [job_bmf_turismo_994] IA2 concluída: OK
2025-12-05 15:07:18.977 | INFO     | watcher:process_job:153 - [job_bmf_turismo_994] Gerando relatório final…
2025-12-05 15:07:18.987 | INFO     | relatorio:gerar_relatorio_final:86 - Relatórios finais gerados em outbox\job_bmf_turismo_994\resultado
2025-12-05 15:07:18.988 | INFO     | watcher:process_job:155 - [job_bmf_turismo_994] Relatório final gerado.
2025-12-05 15:07:19.020 | ERROR    | watcher:process_job:162 - [job_bmf_turismo_994] Erro durante o processamento do job: registrar_evento() got multiple values for argument 'nivel'
Traceback (most recent call last):

  File "C:\Python313\Lib\threading.py", line 1014, in _bootstrap
    self._bootstrap_inner()
    │    └ <function Thread._bootstrap_inner at 0x00000201F0F22340>
    └ <Thread(ScriptRunner.scriptThread, started 11048)>
  File "C:\Python313\Lib\threading.py", line 1043, in _bootstrap_inner
    self.run()
    │    └ <function Thread.run at 0x00000201F0F220C0>
    └ <Thread(ScriptRunner.scriptThread, started 11048)>
  File "C:\Python313\Lib\threading.py", line 994, in run
    self._target(*self._args, **self._kwargs)
    │    │        │    │        │    └ {}
    │    │        │    │        └ <Thread(ScriptRunner.scriptThread, started 11048)>
    │    │        │    └ ()
    │    │        └ <Thread(ScriptRunner.scriptThread, started 11048)>
    │    └ <bound method ScriptRunner._run_script_thread of ScriptRunner(_session_id='b8009e62-6d56-43e4-9733-175f648f0808', _main_scrip...
    └ <Thread(ScriptRunner.scriptThread, started 11048)>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 378, in _run_script_thread
    self._run_script(request.rerun_data)
    │    │           │       └ <property object at 0x00000201F37F2CA0>
    │    │           └ ScriptRequest(type=<ScriptRequestType.RERUN: 'RERUN'>, _rerun_data=RerunData(widget_states=, page_script_hash='5bc02cefb3ea9e...
    │    └ <function ScriptRunner._run_script at 0x00000201F43E45E0>
    └ ScriptRunner(_session_id='b8009e62-6d56-43e4-9733-175f648f0808', _main_script_path='main.py', _session_state={}, _uploaded_fi...
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 685, in _run_script
    ) = exec_func_with_error_handling(code_to_exec, ctx)
        │                             │             └ ScriptRunContext(session_id='b8009e62-6d56-43e4-9733-175f648f0808', _enqueue=<bound method ScriptRunner._enqueue_forward_msg ...
        │                             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000201F4BFFE20>
        └ <function exec_func_with_error_handling at 0x00000201F435F740>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\exec_code.py", line 129, in exec_func_with_error_handling
    result = func()
             └ <function ScriptRunner._run_script.<locals>.code_to_exec at 0x00000201F4BFFE20>
  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\.venv\Lib\site-packages\streamlit\runtime\scriptrunner\script_runner.py", line 669, in code_to_exec
    exec(code, module.__dict__)  # noqa: S102
         │     │      └ <member '__dict__' of 'module' objects>
         │     └ <module '__main__' from 'main.py'>
         └ <code object <module> at 0x00000201F3CC50A0, file "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OC...

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 158, in <module>
    main()
    └ <function main at 0x00000201F6D2A840>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\main.py", line 155, in main
    detect_and_move_jobs(run_once=False)
    └ <function detect_and_move_jobs at 0x00000201A75F3E20>

  File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 177, in detect_and_move_jobs
    process_job(job_dir)
    │           └ WindowsPath('inbox/job_bmf_turismo_994')
    └ <function process_job at 0x00000201A75F3D80>

> File "C:\Users\walte\OneDrive\Workspace\IA\LICITANET\Projeto_Valida\Licitanet_OCR_OpenAI_V2\watcher.py", line 159, in process_job
    registrar_evento(job_id, "WATCHER", "Pipeline concluído com sucesso", nivel="info")
    │                └ 'job_bmf_turismo_994'
    └ <function registrar_evento at 0x00000201F4CEC540>

TypeError: registrar_evento() got multiple values for argument 'nivel'
2025-12-05 15:07:19.033 | INFO     | log_service:registrar_evento:164 - [WATCHER] Pipeline falhou: registrar_evento() got multiple values for argument 'nivel'
